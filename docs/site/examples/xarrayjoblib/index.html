
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://flyvis.github.io/examples/xarrayjoblib/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38">
    
    
      
        <title>Xarrayjoblib - Flyvis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Flyvis" class="md-header__button md-logo" aria-label="Flyvis" data-md-component="logo">
      
  <img src="../../images/logo_hexagon.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Flyvis
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Xarrayjoblib
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Flyvis" class="md-nav__button md-logo" aria-label="Flyvis" data-md-component="logo">
      
  <img src="../../images/logo_hexagon.jpg" alt="logo">

    </a>
    Flyvis
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_flyvision_connectome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explore the connectome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_flyvision_optic_flow_task/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Train the network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_flyvision_flash_responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flash responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_flyvision_moving_edge_responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Moving edge responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_flyvision_umap_and_clustering_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ensemble clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_flyvision_maximally_excitatory_stimuli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maximally excitatory stimuli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_flyvision_providing_custom_stimuli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom stimuli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/connectome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Connectome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/network/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/sintel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sintel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/flash_responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flash Responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/moving_stimulus_responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Moving Stimulus Responses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/ensemble_clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ensemble Clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/optimal_stimuli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimal Stimuli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgements
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Xarrayjoblib</h1>

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">nnf</span>

<span class="kn">from</span> <span class="nn">flyvision</span> <span class="kn">import</span> <span class="n">EnsembleView</span><span class="p">,</span> <span class="n">NetworkView</span><span class="p">,</span> <span class="n">results_dir</span>
<span class="kn">from</span> <span class="nn">flyvision.analysis.stimulus_responses</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">central_impulses_responses</span><span class="p">,</span>
    <span class="n">flash_responses</span><span class="p">,</span>
    <span class="n">moving_bar_responses</span><span class="p">,</span>
    <span class="n">moving_edge_responses</span><span class="p">,</span>
    <span class="n">spatial_impulses_responses</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">flyvision.utils.cluster_utils</span> <span class="kn">import</span> <span class="n">get_status</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>

<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ensemble</span> <span class="o">=</span> <span class="n">EnsembleView</span><span class="p">(</span><span class="s2">&quot;flow/9997&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Loading ensemble:   0%|          | 0/50 [00:00&lt;?, ?it/s]


[2024-09-19 23:43:16] ensemble:133 Loaded 50 networks.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">cluster_indices</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">cluster_indices</span><span class="p">(</span><span class="s2">&quot;T4c&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[2024-09-19 23:43:25] network:251 Initialized network with NumberOfParams(free=734, fixed=2959) parameters.
[2024-09-19 23:43:25] chkpt_utils:72 Recovered network state.
[2024-09-19 23:43:25] logger:80 [MemorizedFunc(func=&lt;function compute_responses at 0x7f2411e8f550&gt;, location=/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/9997/000/__cache__)]: Clearing function cache identified by flyvision/analysis/stimulus_responses/compute_responses
[2024-09-19 23:43:31] chkpt_utils:72 Recovered network state.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;form&#39;: &#39;value&#39;, &#39;requires_grad&#39;: False, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;groupby&#39;: [&#39;source_type&#39;, &#39;target_type&#39;]}, &#39;syn_count&#39;: {&#39;type&#39;: &#39;SynapseCount&#39;, &#39;initial_dist&#39;: &#39;Lognormal&#39;, &#39;mode&#39;: &#39;mean&#39;, &#39;requires_grad&#39;: False, &#39;std&#39;: 1.0, &#39;groupby&#39;: [&#39;source_type&#39;, &#39;target_type&#39;, &#39;dv&#39;, &#39;du&#39;], &#39;penalize&#39;: {&#39;function&#39;: &#39;weight_decay&#39;, &#39;kwargs&#39;: {&#39;lambda&#39;: 0}}}, &#39;syn_strength&#39;: {&#39;type&#39;: &#39;SynapseCountS..., 
&lt;class &#39;flyvision.datasets.sintel.AugmentedSintel&#39;&gt;, { &#39;boxfilter&#39;: {&#39;extent&#39;: 15, &#39;kernel_size&#39;: 13},
  &#39;dt&#39;: 0.01,
  &#39;interpolate&#39;: False,
  &#39;tasks&#39;: [&#39;flow&#39;],
  &#39;temporal_split&#39;: True}, 
4, 0.0, 2.0)


[2024-09-19 23:43:36] network:748 Computing 2268 stimulus responses.



Batch:   0%|          | 0/567 [00:00&lt;?, ?it/s]


Store item /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/9997/000/__cache__/flyvision/analysis/stimulus_responses/compute_responses/1b552fa7f56e5cec50d6641a98ee2d8e/output.zarr
______________________________________________compute_responses - 263.9s, 4.4min
________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;form&#39;: &#39;value&#39;, &#39;requires_grad&#39;: False, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;groupby&#39;: [&#39;source_type&#39;, &#39;target_type&#39;]}, &#39;syn_count&#39;: {&#39;type&#39;: &#39;SynapseCount&#39;, &#39;initial_dist&#39;: &#39;Lognormal&#39;, &#39;mode&#39;: &#39;mean&#39;, &#39;requires_grad&#39;: False, &#39;std&#39;: 1.0, &#39;groupby&#39;: [&#39;source_type&#39;, &#39;target_type&#39;, &#39;dv&#39;, &#39;du&#39;], &#39;penalize&#39;: {&#39;function&#39;: &#39;weight_decay&#39;, &#39;kwargs&#39;: {&#39;lambda&#39;: 0}}}, &#39;syn_strength&#39;: {&#39;type&#39;: &#39;SynapseCountS..., 
&lt;class &#39;flyvision.datasets.sintel.AugmentedSintel&#39;&gt;, { &#39;boxfilter&#39;: {&#39;extent&#39;: 15, &#39;kernel_size&#39;: 13},
  &#39;dt&#39;: 0.01,
  &#39;interpolate&#39;: False,
  &#39;tasks&#39;: [&#39;flow&#39;],
  &#39;temporal_split&#39;: True}, 
4, 0.0, 2.0)


[2024-09-19 23:47:55] chkpt_utils:72 Recovered network state.
[2024-09-19 23:47:59] network:748 Computing 2268 stimulus responses.



Batch:   0%|          | 0/567 [00:00&lt;?, ?it/s]



---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

Input In [3], in &lt;cell line: 1&gt;()
----&gt; 1 cluster_indices = ensemble.cluster_indices(&quot;T4c&quot;)


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/ensemble.py:603, in Ensemble.cluster_indices(self, cell_type)
    586 def cluster_indices(self, cell_type: str) -&gt; Dict[int, NDArray[int]]:
    587     &quot;&quot;&quot;Clusters from responses to naturalistic stimuli of the given cell type.
    588 
    589      Args:
   (...)
    600          first_cluster = ensemble[cluster_indices[0]]
    601     &quot;&quot;&quot;
--&gt; 603     clustering = self.clustering(cell_type)
    604     cluster_indices = get_cluster_to_indices(
    605         clustering.embedding.mask, clustering.labels, task_error=self.task_error()
    606     )
    608     _models = sorted(np.concatenate(list(cluster_indices.values())))


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/ensemble.py:578, in Ensemble.clustering(self, cell_type)
    572 &quot;&quot;&quot;Return the clustering of the ensemble for a given cell type.&quot;&quot;&quot;
    574 if (
    575     not self.dir.umap_and_clustering
    576     or not self.dir.umap_and_clustering[cell_type]
    577 ):
--&gt; 578     return compute_umap_and_clustering(self, cell_type)
    580 path = self.dir.umap_and_clustering[f&quot;{cell_type}.pickle&quot;]
    581 with open(path, &quot;rb&quot;) as file:


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/clustering.py:667, in compute_umap_and_clustering(ensemble, cell_type, embedding_kwargs, gm_kwargs, subdir)
    664     ensemble.cache[&quot;ensemble_embedding_object&quot;] = embeddings
    665     return embeddings
--&gt; 667 responses = naturalistic_stimuli_responses(ensemble)
    668 embeddings = create_embedding_object(responses)
    670 embedding = embeddings.from_cell_type(cell_type, embedding_kwargs=embedding_kwargs)


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:348, in naturalistic_stimuli_responses(network_view_or_ensemble, dataset, dt, batch_size)
    335 def naturalistic_stimuli_responses(
    336     network_view_or_ensemble: Union[&quot;flyvision.NetworkView&quot;, &quot;flyvision.EnsembleView&quot;],
    337     dataset: Optional[AugmentedSintel] = None,
    338     dt=1 / 100,
    339     batch_size=4,
    340 ) -&gt; xr.Dataset:
    341     default_dataset_config = {
    342         &#39;tasks&#39;: [&quot;flow&quot;],
    343         &#39;interpolate&#39;: False,
   (...)
    346         &#39;dt&#39;: dt,
    347     }
--&gt; 348     return generic_responses(
    349         network_view_or_ensemble,
    350         dataset,
    351         default_dataset_config,
    352         AugmentedSintel,
    353         t_pre=0.0,
    354         t_fade_in=2.0,
    355         batch_size=batch_size,
    356     )


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:192, in generic_responses(network_view_or_ensemble, dataset, dataset_config, default_dataset_cls, t_pre, t_fade_in, batch_size, cell_index)
    189 network = handle_network(0, network_views[0], None)
    191 for idx, network_view in enumerate(network_views[1:], 1):
--&gt; 192     handle_network(idx, network_view, network)
    194 # TODO: as long as the concatenation is not lazy, this pattern might not be
    195 # the best way to handle the results. See also https://github.com/pydata/xarray/issues/4628.
    196 result = xr.concat(results, dim=&#39;network_id&#39;, data_vars=&#39;minimal&#39;, coords=&#39;minimal&#39;)


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:177, in generic_responses.&lt;locals&gt;.handle_network(idx, network_view, network)
    173     checkpointed_network.init()
    175 # Call the cached compute_responses function
    176 results.append(
--&gt; 177     cached_compute_responses_fn(
    178         checkpointed_network,
    179         dataset_class,
    180         dataset_config,
    181         batch_size,
    182         t_pre,
    183         t_fade_in,
    184     )  # type: xr.Dataset
    185 )
    186 checkpoints.append(checkpointed_network.checkpoint)
    187 return checkpointed_network.network


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:655, in MemorizedFunc.__call__(self, *args, **kwargs)
    654 def __call__(self, *args, **kwargs):
--&gt; 655     return self._cached_call(args, kwargs)[0]


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:598, in MemorizedFunc._cached_call(self, args, kwargs, shelving)
    595     must_call = True
    597 if must_call:
--&gt; 598     out, metadata = self.call(*args, **kwargs)
    599     if self.mmap_mode is not None:
    600         # Memmap the output at the first call to be consistent with
    601         # later calls
    602         if self._verbose:


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:856, in MemorizedFunc.call(self, *args, **kwargs)
    854 if self._verbose &gt; 0:
    855     print(format_call(self.func, args, kwargs))
--&gt; 856 output = self.func(*args, **kwargs)
    857 self.store_backend.dump_item(
    858     [func_id, args_id], output, verbose=self._verbose)
    860 duration = time.time() - start_time


File /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:59, in compute_responses(network, dataset_class, dataset_config, batch_size, t_pre, t_fade_in, cell_index)
     56 responses_array = []
     58 # Compute responses
---&gt; 59 for i, (stimulus, responses) in enumerate(
     60     network.stimulus_response(
     61         dataset,
     62         dataset.dt,
     63         t_pre=t_pre,
     64         t_fade_in=t_fade_in,
     65         batch_size=batch_size,
     66     )
     67 ):
     68     if cell_index is not None:
     69         responses = np.take(responses, cell_index, axis=-1)


KeyboardInterrupt:
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.stimulus_responses</span> <span class="kn">import</span> <span class="n">moving_edge_responses</span>
<span class="kn">from</span> <span class="nn">flyvision.analysis.moving_bar_responses</span> <span class="kn">import</span> <span class="n">plot_angular_tuning</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">responses</span> <span class="o">=</span> <span class="n">moving_edge_responses</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">plot_angular_tuning</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span> <span class="s2">&quot;T4c&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ensemble</span> <span class="o">=</span> <span class="n">EnsembleView</span><span class="p">([</span><span class="s2">&quot;flow/0000/000&quot;</span><span class="p">,</span> <span class="s2">&quot;flow/0000/001&quot;</span><span class="p">])</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Loading ensemble:   0%|          | 0/2 [00:00&lt;?, ?it/s]


[2024-09-19 16:27:29] ensemble:133 Loaded 2 networks.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">nv</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.stimulus_responses</span> <span class="kn">import</span> <span class="n">flash_responses</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">flash_responses</span><span class="p">(</span><span class="n">nv</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

Input In [1], in &lt;cell line: 1&gt;()
----&gt; 1 flash_responses(nv, batch_size=4)


NameError: name &#39;flash_responses&#39; is not defined
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:140, in Hasher._batch_setitems(self, items)
    135 try:
    136     # Trying first to compare dict assuming the type of keys is
    137     # consistent and orderable.
    138     # This fails on python 3 when keys are unorderable
    139     # but we keep it in a try as it&#39;s faster.
--&gt; 140     Pickler._batch_setitems(self, iter(sorted(items)))
    141 except TypeError:
    142     # If keys are unorderable, sorting them using their hash. This is
    143     # slower but works in any case.


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:997, in _Pickler._batch_setitems(self, items)
    996     save(k)
--&gt; 997     save(v)
    998 write(SETITEMS)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:603, in _Pickler.save(self, obj, save_persistent_id)
    602 # Save the reduce() output and finally memoize the object
--&gt; 603 self.save_reduce(obj=obj, *rv)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:692, in _Pickler.save_reduce(self, func, args, state, listitems, dictitems, state_setter, obj)
    691 save(func)
--&gt; 692 save(args)
    693 write(REDUCE)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:560, in _Pickler.save(self, obj, save_persistent_id)
    559 if f is not None:
--&gt; 560     f(self, obj)  # Call unbound method with explicit self
    561     return


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:901, in _Pickler.save_tuple(self, obj)
    900 for element in obj:
--&gt; 901     save(element)
    903 if id(obj) in memo:
    904     # Subtle.  d was not in memo when we entered save_tuple(), so
    905     # the process of saving the tuple&#39;s elements must have saved
   (...)
    909     # could have been done in the &quot;for element&quot; loop instead, but
    910     # recursive tuples are a rare thing.


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:578, in _Pickler.save(self, obj, save_persistent_id)
    577 if reduce is not None:
--&gt; 578     rv = reduce(self.proto)
    579 else:


TypeError: &#39;NoneType&#39; object is not callable


During handling of the above exception, another exception occurred:


TypeError                                 Traceback (most recent call last)

Input In [6], in &lt;cell line: 1&gt;()
----&gt; 1 x(nv)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:655, in MemorizedFunc.__call__(self, *args, **kwargs)
    654 def __call__(self, *args, **kwargs):
--&gt; 655     return self._cached_call(args, kwargs)[0]


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:528, in MemorizedFunc._cached_call(self, args, kwargs, shelving)
    500 def _cached_call(self, args, kwargs, shelving=False):
    501     &quot;&quot;&quot;Call wrapped function and cache result, or read cache if available.
    502 
    503     This function returns the wrapped function output and some metadata.
   (...)
    526         Some metadata about wrapped function call (see _persist_input()).
    527     &quot;&quot;&quot;
--&gt; 528     func_id, args_id = self._get_output_identifiers(*args, **kwargs)
    529     metadata = None
    530     msg = None


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:699, in MemorizedFunc._get_output_identifiers(self, *args, **kwargs)
    697 &quot;&quot;&quot;Return the func identifier and input parameter hash of a result.&quot;&quot;&quot;
    698 func_id = _build_func_identifier(self.func)
--&gt; 699 argument_hash = self._get_argument_hash(*args, **kwargs)
    700 return func_id, argument_hash


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/memory.py:693, in MemorizedFunc._get_argument_hash(self, *args, **kwargs)
    692 def _get_argument_hash(self, *args, **kwargs):
--&gt; 693     return hashing.hash(filter_args(self.func, self.ignore, args, kwargs),
    694                         coerce_mmap=(self.mmap_mode is not None))


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:265, in hash(obj, hash_name, coerce_mmap)
    263 else:
    264     hasher = Hasher(hash_name=hash_name)
--&gt; 265 return hasher.hash(obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:63, in Hasher.hash(self, obj, return_digest)
     61 def hash(self, obj, return_digest=True):
     62     try:
---&gt; 63         self.dump(obj)
     64     except pickle.PicklingError as e:
     65         e.args += (&#39;PicklingError while hashing %r: %r&#39; % (obj, e),)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:487, in _Pickler.dump(self, obj)
    485 if self.proto &gt;= 4:
    486     self.framer.start_framing()
--&gt; 487 self.save(obj)
    488 self.write(STOP)
    489 self.framer.end_framing()


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    239     self._hash.update(pickle.dumps(obj))
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     87         cls = obj.__self__.__class__
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:560, in _Pickler.save(self, obj, save_persistent_id)
    558 f = self.dispatch.get(t)
    559 if f is not None:
--&gt; 560     f(self, obj)  # Call unbound method with explicit self
    561     return
    563 # Check private dispatch table if any, or else
    564 # copyreg.dispatch_table


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:971, in _Pickler.save_dict(self, obj)
    968     self.write(MARK + DICT)
    970 self.memoize(obj)
--&gt; 971 self._batch_setitems(obj.items())


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:144, in Hasher._batch_setitems(self, items)
    140     Pickler._batch_setitems(self, iter(sorted(items)))
    141 except TypeError:
    142     # If keys are unorderable, sorting them using their hash. This is
    143     # slower but works in any case.
--&gt; 144     Pickler._batch_setitems(self, iter(sorted((hash(k), v)
    145                                               for k, v in items)))


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:997, in _Pickler._batch_setitems(self, items)
    995     for k, v in tmp:
    996         save(k)
--&gt; 997         save(v)
    998     write(SETITEMS)
    999 elif n:


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    239     self._hash.update(pickle.dumps(obj))
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     87         cls = obj.__self__.__class__
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:603, in _Pickler.save(self, obj, save_persistent_id)
    599     raise PicklingError(&quot;Tuple returned by %s must have &quot;
    600                         &quot;two to six elements&quot; % reduce)
    602 # Save the reduce() output and finally memoize the object
--&gt; 603 self.save_reduce(obj=obj, *rv)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:692, in _Pickler.save_reduce(self, func, args, state, listitems, dictitems, state_setter, obj)
    690 else:
    691     save(func)
--&gt; 692     save(args)
    693     write(REDUCE)
    695 if obj is not None:
    696     # If the object is already in the memo, this means it is
    697     # recursive. In this case, throw away everything we put on the
    698     # stack, and fetch the object back from the memo.


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    239     self._hash.update(pickle.dumps(obj))
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     87         cls = obj.__self__.__class__
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:560, in _Pickler.save(self, obj, save_persistent_id)
    558 f = self.dispatch.get(t)
    559 if f is not None:
--&gt; 560     f(self, obj)  # Call unbound method with explicit self
    561     return
    563 # Check private dispatch table if any, or else
    564 # copyreg.dispatch_table


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:901, in _Pickler.save_tuple(self, obj)
    899 write(MARK)
    900 for element in obj:
--&gt; 901     save(element)
    903 if id(obj) in memo:
    904     # Subtle.  d was not in memo when we entered save_tuple(), so
    905     # the process of saving the tuple&#39;s elements must have saved
   (...)
    909     # could have been done in the &quot;for element&quot; loop instead, but
    910     # recursive tuples are a rare thing.
    911     get = self.get(memo[id(obj)][0])


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:241, in NumpyHasher.save(self, obj)
    239     self._hash.update(pickle.dumps(obj))
    240     return
--&gt; 241 Hasher.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/joblib/hashing.py:89, in Hasher.save(self, obj)
     87         cls = obj.__self__.__class__
     88         obj = _MyHash(func_name, inst, cls)
---&gt; 89 Pickler.save(self, obj)


File ~/miniconda3/envs/flyvision/lib/python3.9/pickle.py:578, in _Pickler.save(self, obj, save_persistent_id)
    576 reduce = getattr(obj, &quot;__reduce_ex__&quot;, None)
    577 if reduce is not None:
--&gt; 578     rv = reduce(self.proto)
    579 else:
    580     reduce = getattr(obj, &quot;__reduce__&quot;, None)


TypeError: &#39;NoneType&#39; object is not callable
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">r</span> <span class="o">=</span> <span class="n">flash_responses</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[2024-09-19 15:40:19] logger:80 [MemorizedFunc(func=&lt;function compute_responses at 0x7fb8953669d0&gt;, location=/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/__cache__)]: Clearing function cache identified by flyvision/analysis/stimulus_responses/compute_responses


call in cache
Zarr directory exists at /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/__cache__/flyvision/analysis/stimulus_responses/compute_responses/36cc2e714bcc32d4310f6c8f5a3b3a22/output.zarr
call in cache


[2024-09-19 15:40:19] chkpt_utils:72 Recovered network state.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)


[2024-09-19 15:40:19] network:747 Computing 4 stimulus responses.



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


Store item /groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/__cache__/flyvision/analysis/stimulus_responses/compute_responses/0c7c0da65596c80075f59c01e695a49c/output.zarr
________________________________________________compute_responses - 3.2s, 0.1min
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">r</span><span class="p">[</span><span class="s1">&#39;responses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>array([[[[ 1.26998270e+00,  1.14091361e+00,  8.79052460e-01, ...,
          -6.65360272e-01,  4.84376013e-01,  1.56474614e+00],
         [ 1.26998210e+00,  1.14091325e+00,  8.79052281e-01, ...,
          -6.65285587e-01,  4.84358519e-01,  1.56486785e+00],
         [ 1.26998150e+00,  1.14091289e+00,  8.79052103e-01, ...,
          -6.65213525e-01,  4.84341621e-01,  1.56498337e+00],
         ...,
         [ 1.27000153e+00,  1.14092326e+00,  8.79057825e-01, ...,
          -6.65505469e-01,  4.84511584e-01,  1.56172812e+00],
         [ 1.27000058e+00,  1.14092278e+00,  8.79057527e-01, ...,
          -6.65413439e-01,  4.84495133e-01,  1.56193316e+00],
         [ 1.26999962e+00,  1.14092231e+00,  8.79057229e-01, ...,
          -6.65324688e-01,  4.84478980e-01,  1.56213117e+00]],

        [[ 1.26998270e+00,  1.14091361e+00,  8.79052460e-01, ...,
          -6.65360272e-01,  4.84376013e-01,  1.56474614e+00],
         [ 1.26998210e+00,  1.14091325e+00,  8.79052281e-01, ...,
          -6.65285528e-01,  4.84358549e-01,  1.56486785e+00],
         [ 1.26998150e+00,  1.14091289e+00,  8.79052103e-01, ...,
          -6.65213525e-01,  4.84341681e-01,  1.56498337e+00],
         ...,
         [ 1.26999938e+00,  1.14092231e+00,  8.79057169e-01, ...,
          -6.64689541e-01,  4.84426320e-01,  1.56245875e+00],
         [ 1.26999855e+00,  1.14092183e+00,  8.79056931e-01, ...,
          -6.64619029e-01,  4.84410375e-01,  1.56263471e+00],
         [ 1.26999772e+00,  1.14092135e+00,  8.79056692e-01, ...,
          -6.64551556e-01,  4.84394759e-01,  1.56280386e+00]],

        [[ 1.26998270e+00,  1.14091361e+00,  8.79052460e-01, ...,
          -6.65360272e-01,  4.84376013e-01,  1.56474614e+00],
         [ 1.26998210e+00,  1.14091325e+00,  8.79052281e-01, ...,
          -6.65285587e-01,  4.84358549e-01,  1.56486785e+00],
         [ 1.26998150e+00,  1.14091289e+00,  8.79052103e-01, ...,
          -6.65213466e-01,  4.84341681e-01,  1.56498337e+00],
         ...,
         [ 1.26996088e+00,  1.14090216e+00,  8.79046261e-01, ...,
          -6.63660169e-01,  4.84010607e-01,  1.56863821e+00],
         [ 1.26996136e+00,  1.14090240e+00,  8.79046381e-01, ...,
          -6.63626075e-01,  4.84002650e-01,  1.56859958e+00],
         [ 1.26996183e+00,  1.14090264e+00,  8.79046500e-01, ...,
          -6.63593173e-01,  4.83994961e-01,  1.56855977e+00]],

        [[ 1.26998270e+00,  1.14091361e+00,  8.79052460e-01, ...,
          -6.65360272e-01,  4.84376013e-01,  1.56474614e+00],
         [ 1.26998210e+00,  1.14091325e+00,  8.79052281e-01, ...,
          -6.65285528e-01,  4.84358519e-01,  1.56486785e+00],
         [ 1.26998150e+00,  1.14091289e+00,  8.79052103e-01, ...,
          -6.65213466e-01,  4.84341651e-01,  1.56498337e+00],
         ...,
         [ 1.26996148e+00,  1.14090240e+00,  8.79046440e-01, ...,
          -6.63580477e-01,  4.83976334e-01,  1.56881285e+00],
         [ 1.26996207e+00,  1.14090264e+00,  8.79046559e-01, ...,
          -6.63551450e-01,  4.83968198e-01,  1.56876075e+00],
         [ 1.26996255e+00,  1.14090300e+00,  8.79046738e-01, ...,
          -6.63523316e-01,  4.83960509e-01,  1.56870782e+00]]],


       [[[ 2.26847947e-01,  1.73184633e+00,  3.66457075e-01, ...,
           4.38959032e-01,  1.15676522e+00, -9.46795451e-04],
         [ 2.26922005e-01,  1.73270357e+00,  3.66352379e-01, ...,
           4.38438445e-01,  1.15802646e+00, -8.05967429e-04],
         [ 2.26995245e-01,  1.73355222e+00,  3.66249621e-01, ...,
           4.37931597e-01,  1.15926170e+00, -6.67890650e-04],
         ...,
         [ 2.32199892e-01,  1.79689252e+00,  3.60339612e-01, ...,
           4.07203078e-01,  1.23493397e+00,  1.45732462e-02],
         [ 2.32207999e-01,  1.79692674e+00,  3.60299319e-01, ...,
           4.06869888e-01,  1.23555434e+00,  1.48489913e-02],
         [ 2.32216313e-01,  1.79696441e+00,  3.60260069e-01, ...,
           4.06542301e-01,  1.23616111e+00,  1.51194008e-02]],

        [[ 2.26847947e-01,  1.73184633e+00,  3.66457075e-01, ...,
           4.38959032e-01,  1.15676522e+00, -9.46825719e-04],
         [ 2.26922005e-01,  1.73270357e+00,  3.66352379e-01, ...,
           4.38438445e-01,  1.15802646e+00, -8.06012831e-04],
         [ 2.26995245e-01,  1.73355222e+00,  3.66249621e-01, ...,
           4.37931627e-01,  1.15926170e+00, -6.67920976e-04],
         ...,
         [ 2.32457072e-01,  1.79971373e+00,  3.59658748e-01, ...,
           4.01285648e-01,  1.24299502e+00,  1.82700194e-02],
         [ 2.32460201e-01,  1.79968691e+00,  3.59628052e-01, ...,
           4.00977790e-01,  1.24349368e+00,  1.84929017e-02],
         [ 2.32463762e-01,  1.79966605e+00,  3.59598309e-01, ...,
           4.00675088e-01,  1.24398196e+00,  1.87107958e-02]],

        [[ 2.26847947e-01,  1.73184633e+00,  3.66457075e-01, ...,
           4.38959032e-01,  1.15676522e+00, -9.46795451e-04],
         [ 2.26922005e-01,  1.73270357e+00,  3.66352379e-01, ...,
           4.38438475e-01,  1.15802646e+00, -8.05967429e-04],
         [ 2.26995245e-01,  1.73355222e+00,  3.66249621e-01, ...,
           4.37931687e-01,  1.15926170e+00, -6.67920918e-04],
         ...,
         [ 2.34749660e-01,  1.82607627e+00,  3.56502026e-01, ...,
           3.77276391e-01,  1.29048550e+00,  3.32663991e-02],
         [ 2.34736368e-01,  1.82585859e+00,  3.56509507e-01, ...,
           3.77202153e-01,  1.29056251e+00,  3.33554670e-02],
         [ 2.34723553e-01,  1.82564819e+00,  3.56517464e-01, ...,
           3.77132207e-01,  1.29063022e+00,  3.34387310e-02]],

        [[ 2.26847947e-01,  1.73184633e+00,  3.66457075e-01, ...,
           4.38959032e-01,  1.15676522e+00, -9.46825719e-04],
         [ 2.26922005e-01,  1.73270357e+00,  3.66352379e-01, ...,
           4.38438475e-01,  1.15802646e+00, -8.05997697e-04],
         [ 2.26995245e-01,  1.73355222e+00,  3.66249621e-01, ...,
           4.37931627e-01,  1.15926170e+00, -6.67875574e-04],
         ...,
         [ 2.34463289e-01,  1.82269490e+00,  3.57069880e-01, ...,
           3.81346226e-01,  1.28545821e+00,  3.04317325e-02],
         [ 2.34454304e-01,  1.82253230e+00,  3.57072860e-01, ...,
           3.81256282e-01,  1.28554511e+00,  3.05252597e-02],
         [ 2.34445736e-01,  1.82237637e+00,  3.57076257e-01, ...,
           3.81170303e-01,  1.28562391e+00,  3.06138750e-02]]]])
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;responses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>numpy.ndarray
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">r</span><span class="o">.</span><span class="n">custom</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cell_type</span><span class="o">=</span><span class="s2">&quot;T4c&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;&lt;0.5&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

Input In [562], in &lt;cell line: 1&gt;()
----&gt; 1 r.custom.where(cell_type=&quot;T4c&quot;, time=&#39;&lt;0.5&#39;).plot()


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/xarray/plot/accessor.py:942, in DatasetPlotAccessor.__call__(self, *args, **kwargs)
    941 def __call__(self, *args, **kwargs) -&gt; NoReturn:
--&gt; 942     raise ValueError(
    943         &quot;Dataset.plot cannot be called directly. Use &quot;
    944         &quot;an explicit plot method, e.g. ds.plot.scatter(...)&quot;
    945     )


ValueError: Dataset.plot cannot be called directly. Use an explicit plot method, e.g. ds.plot.scatter(...)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.simple_correlation</span> <span class="kn">import</span> <span class="n">correlation</span>
<span class="kn">from</span> <span class="nn">flyvision.utils</span> <span class="kn">import</span> <span class="n">groundtruth_utils</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.flash_responses</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">flash_response_index</span><span class="p">,</span>
    <span class="n">fri_correlation_to_known</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fris</span> <span class="o">=</span> <span class="n">flash_response_index</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">fri_correlation_to_known</span><span class="p">(</span><span class="n">fris</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (network_id: 2, sample: 1)&gt;
array([[0.80960086],
       [0.80693697]])
Coordinates:
  * network_id   (network_id) int64 0 1
    baseline     (sample) float64 0.5
    radius       (sample) int64 6
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...
Dimensions without coordinates: sample</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span>sample</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-34a779be-dce4-4da0-9355-ac7d4d2449f1' class='xr-array-in' type='checkbox' checked><label for='section-34a779be-dce4-4da0-9355-ac7d4d2449f1' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.8096 0.8069</span></div><div class='xr-array-data'><pre>array([[0.80960086],
       [0.80693697]])</pre></div></div></li><li class='xr-section-item'><input id='section-b7d8e0e8-1abe-4ea8-94aa-971179470a8d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b7d8e0e8-1abe-4ea8-94aa-971179470a8d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-208176db-80d3-4f66-9908-21ad76694eff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-208176db-80d3-4f66-9908-21ad76694eff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47a48e8b-a4f8-4680-b005-91d2488a06e6' class='xr-var-data-in' type='checkbox'><label for='data-47a48e8b-a4f8-4680-b005-91d2488a06e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>baseline</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5</div><input id='attrs-5e603a94-171d-4842-8694-203ad6b577ff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5e603a94-171d-4842-8694-203ad6b577ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15f99c75-cc71-4dfb-aa68-ce078680b5bb' class='xr-var-data-in' type='checkbox'><label for='data-15f99c75-cc71-4dfb-aa68-ce078680b5bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radius</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6</div><input id='attrs-168af5e8-c8b1-4643-ac82-88be834be535' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-168af5e8-c8b1-4643-ac82-88be834be535' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da9ae826-3d9e-4733-8d47-d75a061c5e62' class='xr-var-data-in' type='checkbox'><label for='data-da9ae826-3d9e-4733-8d47-d75a061c5e62' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-7d907ef0-a0d0-454e-85c7-7464f034d5a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d907ef0-a0d0-454e-85c7-7464f034d5a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4be19128-1f36-4c33-b5fb-0b5c4e2b33d0' class='xr-var-data-in' type='checkbox'><label for='data-4be19128-1f36-4c33-b5fb-0b5c4e2b33d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9af12bec-0c6d-450b-8b60-7647c5943d9f' class='xr-section-summary-in' type='checkbox'  ><label for='section-9af12bec-0c6d-450b-8b60-7647c5943d9f' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1d6c0c64-9923-463e-a7b6-9a40d6419047' class='xr-index-data-in' type='checkbox'/><label for='index-1d6c0c64-9923-463e-a7b6-9a40d6419047' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-61257c40-34d2-4078-ab56-3cdcb7f015f9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-61257c40-34d2-4078-ab56-3cdcb7f015f9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">r</span> <span class="o">=</span> <span class="n">moving_edge_responses</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">speeds</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">offsets</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>call in cache
call in cache
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.moving_bar_responses</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">direction_selectivity_index</span><span class="p">,</span>
    <span class="n">get_time_masks</span><span class="p">,</span>
    <span class="n">peak_responses</span><span class="p">,</span>
    <span class="n">peak_responses_angular</span><span class="p">,</span>
    <span class="n">preferred_direction</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">preferred_direction</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (network_id: 2, neuron: 65, intensity: 2)&gt;
array([[[-1.45409812e-01,  1.14432681e+00],
        [-9.62252107e-13,  5.99157085e-01],
        [-4.08941150e-13,  1.13965543e+00],
        [-2.22000780e-01,  1.14465379e+00],
        [-4.32689046e-01,  1.18060851e+00],
        [-2.09103564e+00,  1.14558450e+00],
        [-2.23311971e-13,  3.14159265e+00],
        [-2.23017858e-13, -3.08158205e-11],
        [ 0.00000000e+00,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00],
        [-1.10966079e+00,  5.87139353e-01],
        [-1.03336630e+00,  1.57079633e+00],
        [-2.05912039e+00,  7.17909389e-02],
        [ 0.00000000e+00,  0.00000000e+00],
        [-2.37817679e+00,  1.76616951e-01],
        [ 0.00000000e+00,  0.00000000e+00],
        [-1.78946527e+00, -1.64230814e+00],
        [ 2.48722963e+00, -2.06809747e+00],
        [ 3.79276538e-02,  7.96743874e-01],
        [-2.57616066e+00,  8.71883716e-01],
...
        [ 1.04448801e+00, -1.20075429e-01],
        [ 4.28249427e-01,  0.00000000e+00],
        [ 3.59000058e-01,  2.97415837e+00],
        [ 2.96230948e+00,  2.07275550e+00],
        [ 1.25311650e+00,  1.57271571e+00],
        [ 2.30960222e-01,  2.61799388e+00],
        [ 2.52816532e-01,  0.00000000e+00],
        [-1.09909854e+00, -3.10067051e+00],
        [ 2.38115894e-01,  0.00000000e+00],
        [ 9.33658938e-01,  2.94982890e+00],
        [-1.26624535e+00,  2.46788810e+00],
        [-7.07413398e-02, -3.10107988e+00],
        [-2.56214694e+00, -2.31216017e+00],
        [-2.52406902e+00, -2.50096814e+00],
        [ 4.78682585e-01,  3.57782381e-01],
        [-2.21087128e+00,  1.18826756e+00],
        [-1.63206802e+00,  1.77147327e+00],
        [ 1.60169098e+00, -7.08962709e-02],
        [-5.76669296e-01, -7.29345144e-01],
        [-3.08845703e+00,  9.30896627e-02]]])
Coordinates:
  * intensity    (intensity) int64 0 1
  * network_id   (network_id) int64 0 1
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7 8 ... 56 57 58 59 60 61 62 63 64
    cell_type    (neuron) &lt;U8 &#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; &#x27;R4&#x27; ... &#x27;TmY14&#x27; &#x27;TmY15&#x27; &#x27;TmY18&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>neuron</span>: 65</li><li><span class='xr-has-index'>intensity</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-cd38630b-04c0-4fad-aaff-8f9c7631fdb8' class='xr-array-in' type='checkbox' checked><label for='section-cd38630b-04c0-4fad-aaff-8f9c7631fdb8' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.1454 1.144 -9.623e-13 0.5992 ... -0.5767 -0.7293 -3.088 0.09309</span></div><div class='xr-array-data'><pre>array([[[-1.45409812e-01,  1.14432681e+00],
        [-9.62252107e-13,  5.99157085e-01],
        [-4.08941150e-13,  1.13965543e+00],
        [-2.22000780e-01,  1.14465379e+00],
        [-4.32689046e-01,  1.18060851e+00],
        [-2.09103564e+00,  1.14558450e+00],
        [-2.23311971e-13,  3.14159265e+00],
        [-2.23017858e-13, -3.08158205e-11],
        [ 0.00000000e+00,  0.00000000e+00],
        [ 0.00000000e+00,  0.00000000e+00],
        [-1.10966079e+00,  5.87139353e-01],
        [-1.03336630e+00,  1.57079633e+00],
        [-2.05912039e+00,  7.17909389e-02],
        [ 0.00000000e+00,  0.00000000e+00],
        [-2.37817679e+00,  1.76616951e-01],
        [ 0.00000000e+00,  0.00000000e+00],
        [-1.78946527e+00, -1.64230814e+00],
        [ 2.48722963e+00, -2.06809747e+00],
        [ 3.79276538e-02,  7.96743874e-01],
        [-2.57616066e+00,  8.71883716e-01],
...
        [ 1.04448801e+00, -1.20075429e-01],
        [ 4.28249427e-01,  0.00000000e+00],
        [ 3.59000058e-01,  2.97415837e+00],
        [ 2.96230948e+00,  2.07275550e+00],
        [ 1.25311650e+00,  1.57271571e+00],
        [ 2.30960222e-01,  2.61799388e+00],
        [ 2.52816532e-01,  0.00000000e+00],
        [-1.09909854e+00, -3.10067051e+00],
        [ 2.38115894e-01,  0.00000000e+00],
        [ 9.33658938e-01,  2.94982890e+00],
        [-1.26624535e+00,  2.46788810e+00],
        [-7.07413398e-02, -3.10107988e+00],
        [-2.56214694e+00, -2.31216017e+00],
        [-2.52406902e+00, -2.50096814e+00],
        [ 4.78682585e-01,  3.57782381e-01],
        [-2.21087128e+00,  1.18826756e+00],
        [-1.63206802e+00,  1.77147327e+00],
        [ 1.60169098e+00, -7.08962709e-02],
        [-5.76669296e-01, -7.29345144e-01],
        [-3.08845703e+00,  9.30896627e-02]]])</pre></div></div></li><li class='xr-section-item'><input id='section-df66aa47-7d55-4669-ba84-85443143637d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-df66aa47-7d55-4669-ba84-85443143637d' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>intensity</span></div><div class='xr-var-dims'>(intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-a0868b9b-5b5d-4e2c-b201-9aa58ca363ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0868b9b-5b5d-4e2c-b201-9aa58ca363ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6e41b71-71e8-4a65-b799-bb08b7cd81b9' class='xr-var-data-in' type='checkbox'><label for='data-a6e41b71-71e8-4a65-b799-bb08b7cd81b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-453d03f3-ce40-4928-9eac-756bae10e6e9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-453d03f3-ce40-4928-9eac-756bae10e6e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9afc7503-10bc-42fc-a2f6-3e602a1365c0' class='xr-var-data-in' type='checkbox'><label for='data-9afc7503-10bc-42fc-a2f6-3e602a1365c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-c5ad9766-46df-4f78-a825-b95d903dcac8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c5ad9766-46df-4f78-a825-b95d903dcac8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03af9ee6-34cb-4e04-808c-05f7e982cb5a' class='xr-var-data-in' type='checkbox'><label for='data-03af9ee6-34cb-4e04-808c-05f7e982cb5a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-8f680b5e-6456-4cff-8e89-6ac16215fb04' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8f680b5e-6456-4cff-8e89-6ac16215fb04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c095c57-0081-4977-9220-0b9afbd201b5' class='xr-var-data-in' type='checkbox'><label for='data-4c095c57-0081-4977-9220-0b9afbd201b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-a577f791-573f-4149-97ef-6849efcd5234' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a577f791-573f-4149-97ef-6849efcd5234' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-661342b5-4e93-4e22-9e04-a9622d505d09' class='xr-var-data-in' type='checkbox'><label for='data-661342b5-4e93-4e22-9e04-a9622d505d09' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-8c8b24bc-68fe-4721-a5b6-909986e15b64' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8c8b24bc-68fe-4721-a5b6-909986e15b64' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a479ac2e-035a-4a2e-8c22-e94d0a9fb12e' class='xr-var-data-in' type='checkbox'><label for='data-a479ac2e-035a-4a2e-8c22-e94d0a9fb12e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-560336c8-1182-4195-b893-c7490f0a2eca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-560336c8-1182-4195-b893-c7490f0a2eca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02478f24-bd9a-42a3-8ec7-538d3c62c8ee' class='xr-var-data-in' type='checkbox'><label for='data-02478f24-bd9a-42a3-8ec7-538d3c62c8ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-874412af-d63a-469c-8bee-8aa057649403' class='xr-section-summary-in' type='checkbox'  ><label for='section-874412af-d63a-469c-8bee-8aa057649403' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9f168cfe-5e8a-46e1-9405-086d404f3ee5' class='xr-index-data-in' type='checkbox'/><label for='index-9f168cfe-5e8a-46e1-9405-086d404f3ee5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1dc44601-ee10-415e-a89f-0ee91e26cdfb' class='xr-index-data-in' type='checkbox'/><label for='index-1dc44601-ee10-415e-a89f-0ee91e26cdfb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>intensity</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-06dadaf9-a452-4336-a86c-a5a2b8ce64fe' class='xr-index-data-in' type='checkbox'/><label for='index-06dadaf9-a452-4336-a86c-a5a2b8ce64fe' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;intensity&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-76767020-3118-4cd9-b4a6-63a9b12ea5cb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-76767020-3118-4cd9-b4a6-63a9b12ea5cb' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">r</span><span class="o">.</span><span class="n">custom</span><span class="o">.</span><span class="n">plot_traces</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;responses&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">cell_type</span><span class="o">=</span><span class="s1">&#39;T4c&#39;</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>&lt;Axes: xlabel=&#39;time&#39;, ylabel=&#39;responses&#39;&gt;
</code></pre></div>

<p><img alt="png" src="../xarrayjoblib_files/xarrayjoblib_23_1.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.analysis.moving_bar_responses</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">direction_selectivity_index</span><span class="p">,</span>
    <span class="n">peak_responses</span><span class="p">,</span>
    <span class="n">plot_T4_tuning</span><span class="p">,</span>
    <span class="n">plot_T5_tuning</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>


<span class="k">def</span> <span class="nf">tuning_curve_correlation_to_known</span><span class="p">(</span>
    <span class="n">tuning</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;independent&quot;</span><span class="p">,</span>
    <span class="n">aggregate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;absmax&quot;</span><span class="p">,</span>
    <span class="n">aggregate_dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">select_stimuli_indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">respect_contrast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">concatenate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">opposite_contrast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fill_missing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">],</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the correlation between predicted tuning curves and known tuning curves.</span>

<span class="sd">    Args:</span>
<span class="sd">        tuning (xarray.DataArray): DataArray containing the responses,</span>
<span class="sd">            with dimensions including &#39;network_id&#39;, &#39;sample&#39;, &#39;neuron&#39;,</span>
<span class="sd">            and coordinates such as &#39;angle&#39;, &#39;intensity&#39;, &#39;cell_type&#39;.</span>
<span class="sd">        mode (str): &#39;independent&#39; or &#39;joint&#39; -- compute correlations independently or jointly.</span>
<span class="sd">        aggregate (str): &#39;median&#39;, &#39;mean&#39;, &#39;max&#39;, &#39;absmax&#39;, &#39;select&#39; -- method to aggregate over stimulus parameters.</span>
<span class="sd">        aggregate_dims (list): Dimensions along which to aggregate the correlation values.</span>
<span class="sd">        select_stimuli_indices (list): Indices to select specific stimuli for correlations.</span>
<span class="sd">        respect_contrast (bool): If True, compute correlations for preferred contrast tunings.</span>
<span class="sd">        concatenate (bool): If True, concatenate all cell types into one array.</span>
<span class="sd">        opposite_contrast (bool): If True, compute correlations for opposite contrast.</span>
<span class="sd">        interpolate (bool): If True, interpolate ground truth tuning curves to match predicted angles.</span>
<span class="sd">        fill_missing (float): Value to fill missing values with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict or xarray.DataArray: Dictionary of correlations per cell type,</span>
<span class="sd">            or concatenated DataArray if concatenate=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fill missing values and ensure required coordinates</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fill_missing</span><span class="p">)</span>
    <span class="n">required_coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">required_coords</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">):</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="n">required_coords</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required coordinates: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Set default angles and intensities if not provided</span>
    <span class="n">gt_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

    <span class="n">angles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">])</span>
    <span class="n">intensities</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Prepare tuning data</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;t_stim&#39;</span><span class="p">])</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;neuron&#39;</span><span class="p">:</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">})</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">angles</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="n">intensities</span><span class="p">)</span>

    <span class="c1"># Retrieve ground truth tuning curves</span>
    <span class="n">cell_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T4a&#39;</span><span class="p">,</span> <span class="s1">&#39;T4b&#39;</span><span class="p">,</span> <span class="s1">&#39;T4c&#39;</span><span class="p">,</span> <span class="s1">&#39;T4d&#39;</span><span class="p">,</span> <span class="s1">&#39;T5a&#39;</span><span class="p">,</span> <span class="s1">&#39;T5b&#39;</span><span class="p">,</span> <span class="s1">&#39;T5c&#39;</span><span class="p">,</span> <span class="s1">&#39;T5d&#39;</span><span class="p">]</span>
    <span class="n">gt_tuning_curves</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">cell_type</span> <span class="ow">in</span> <span class="n">cell_types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cell_type</span> <span class="ow">in</span> <span class="n">groundtruth_utils</span><span class="o">.</span><span class="n">tuning_curves</span><span class="p">:</span>
            <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">groundtruth_utils</span><span class="o">.</span><span class="n">tuning_curves</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">interpolate</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gt_angles</span><span class="p">):</span>
                <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">gt_angles</span><span class="p">,</span> <span class="n">gt_tuning</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
                <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">interp_func</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
            <span class="n">gt_tuning_curves</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">gt_tuning</span><span class="p">,</span>
                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">],</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="n">angles</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground truth tuning curve for </span><span class="si">{</span><span class="n">cell_type</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>

    <span class="c1"># Compute correlations</span>
    <span class="n">correlations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">other_dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">tuning</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="n">dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">gt_tuning_da</span> <span class="ow">in</span> <span class="n">gt_tuning_curves</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cell_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuning</span><span class="p">[</span><span class="s1">&#39;cell_type&#39;</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cell_type</span><span class="o">=</span><span class="n">cell_type</span><span class="p">)</span>

        <span class="c1"># Handle contrast preference</span>
        <span class="k">if</span> <span class="n">respect_contrast</span> <span class="ow">or</span> <span class="n">opposite_contrast</span><span class="p">:</span>
            <span class="n">intensity_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="s1">&#39;T4&#39;</span> <span class="ow">in</span> <span class="n">cell_type</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">opposite_contrast</span><span class="p">:</span>
                <span class="n">intensity_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">intensity_value</span>
            <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">predicted_tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="n">intensity_value</span><span class="p">)</span>

        <span class="c1"># Stack dimensions for correlation computation</span>
        <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">predicted_tuning</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stim_dims</span><span class="o">=</span><span class="n">other_dims</span><span class="p">)</span>

        <span class="c1"># Compute correlation</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">predicted_tuning</span><span class="p">,</span> <span class="n">gt_tuning_da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">)</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;stim_dims&#39;</span><span class="p">)</span>
        <span class="n">correlations</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>

    <span class="c1"># Handle joint mode</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;joint&#39;</span><span class="p">:</span>
        <span class="n">combined_gt</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">gt_tuning_curves</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">flat_dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">))</span>
        <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cell_type</span><span class="o">=</span><span class="n">ct</span><span class="p">)</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">gt_tuning_curves</span><span class="p">],</span>
            <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">flat_dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">))</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">predicted_tuning</span><span class="p">,</span> <span class="n">combined_gt</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;flat_dim&#39;</span><span class="p">)</span>
        <span class="n">correlations</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;joint&#39;</span><span class="p">:</span> <span class="n">corr</span><span class="p">}</span>

    <span class="c1"># Aggregate correlations</span>
    <span class="k">if</span> <span class="n">aggregate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">agg_funcs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="o">.</span><span class="n">median</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="o">.</span><span class="n">max</span><span class="p">,</span>
            <span class="s1">&#39;absmax&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">da</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)}),</span>
            <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="kc">None</span>  <span class="c1"># Handle &#39;select&#39; separately</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">aggregate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">agg_funcs</span> <span class="ow">and</span> <span class="n">aggregate</span> <span class="o">!=</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid aggregation method: </span><span class="si">{</span><span class="n">aggregate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">corr</span> <span class="ow">in</span> <span class="n">correlations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">aggregate</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">select_stimuli_indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;select_stimuli_indices must be provided when aggregate=&#39;select&#39;&quot;</span><span class="p">)</span>
                <span class="n">indexers</span> <span class="o">=</span> <span class="p">{</span><span class="n">dim</span><span class="p">:</span> <span class="n">select_stimuli_indices</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">aggregate_dims</span><span class="p">}</span>
                <span class="n">correlations</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">indexers</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">agg_funcs</span><span class="p">[</span><span class="n">aggregate</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">aggregate</span> <span class="o">==</span> <span class="s1">&#39;absmax&#39;</span><span class="p">:</span>
                    <span class="n">correlations</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
                        <span class="n">func</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">aggregate_dims</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">aggregate_dims</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">correlations</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">aggregate_dims</span><span class="p">)</span>

    <span class="c1"># Concatenate if requested</span>
    <span class="k">if</span> <span class="n">concatenate</span><span class="p">:</span>
        <span class="n">concatenated</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">corr</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;cell_type&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">corr</span> <span class="ow">in</span> <span class="n">correlations</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cell_type&#39;</span><span class="p">)</span>
        <span class="n">concatenated</span><span class="p">[</span><span class="s1">&#39;cell_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">correlations</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">concatenated</span>

    <span class="k">return</span> <span class="n">correlations</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_independent_correlation</span><span class="p">(</span>
    <span class="n">tuning</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span>
    <span class="n">respect_contrast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">opposite_contrast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">interpolate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fill_missing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the correlation between predicted tuning curves and known tuning curves independently for each cell type.</span>

<span class="sd">    Args:</span>
<span class="sd">        tuning (xarray.DataArray): DataArray containing the responses, with dimensions including &#39;network_id&#39;, &#39;sample&#39;, &#39;neuron&#39;,</span>
<span class="sd">            and coordinates such as &#39;angle&#39;, &#39;intensity&#39;, &#39;cell_type&#39;.</span>
<span class="sd">        respect_contrast (bool): If True, compute correlations for preferred contrast tunings.</span>
<span class="sd">        opposite_contrast (bool): If True, compute correlations for opposite contrast.</span>
<span class="sd">        interpolate (bool): If True, interpolate ground truth tuning curves to match predicted angles.</span>
<span class="sd">        fill_missing (float): Value to fill missing values with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, xr.DataArray]: Dictionary of correlations per cell type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fill missing values and ensure required coordinates</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fill_missing</span><span class="p">)</span>
    <span class="n">required_coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">}</span>
    <span class="n">missing_coords</span> <span class="o">=</span> <span class="n">required_coords</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">missing_coords</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required coordinates: </span><span class="si">{</span><span class="n">missing_coords</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extract angles and intensities from the dataset</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">intensities</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Prepare tuning data</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="s1">&#39;t_stim&#39;</span><span class="p">])</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span>
    <span class="n">tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;neuron&#39;</span><span class="p">:</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">})</span>

    <span class="c1"># Retrieve ground truth tuning curves</span>
    <span class="n">cell_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T4a&#39;</span><span class="p">,</span> <span class="s1">&#39;T4b&#39;</span><span class="p">,</span> <span class="s1">&#39;T4c&#39;</span><span class="p">,</span> <span class="s1">&#39;T4d&#39;</span><span class="p">,</span> <span class="s1">&#39;T5a&#39;</span><span class="p">,</span> <span class="s1">&#39;T5b&#39;</span><span class="p">,</span> <span class="s1">&#39;T5c&#39;</span><span class="p">,</span> <span class="s1">&#39;T5d&#39;</span><span class="p">]</span>
    <span class="n">gt_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">gt_tuning_curves</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">cell_type</span> <span class="ow">in</span> <span class="n">cell_types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cell_type</span> <span class="ow">in</span> <span class="n">groundtruth_utils</span><span class="o">.</span><span class="n">tuning_curves</span><span class="p">:</span>
            <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">groundtruth_utils</span><span class="o">.</span><span class="n">tuning_curves</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">interpolate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">gt_angles</span><span class="p">):</span>
                <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span>
                    <span class="n">gt_angles</span><span class="p">,</span> <span class="n">gt_tuning</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span>
                <span class="p">)</span>
                <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">interp_func</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
            <span class="n">gt_tuning_curves</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">gt_tuning</span><span class="p">,</span>
                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">],</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="n">angles</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground truth tuning curve for </span><span class="si">{</span><span class="n">cell_type</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>

    <span class="c1"># Compute correlations</span>
    <span class="n">correlations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">other_dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">tuning</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="n">dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_type&#39;</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">gt_tuning_da</span> <span class="ow">in</span> <span class="n">gt_tuning_curves</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cell_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuning</span><span class="p">[</span><span class="s1">&#39;cell_type&#39;</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cell_type</span><span class="o">=</span><span class="n">cell_type</span><span class="p">)</span>

        <span class="c1"># Handle contrast preference</span>
        <span class="k">if</span> <span class="n">respect_contrast</span> <span class="ow">or</span> <span class="n">opposite_contrast</span><span class="p">:</span>
            <span class="n">intensity_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="s1">&#39;T4&#39;</span> <span class="ow">in</span> <span class="n">cell_type</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">opposite_contrast</span><span class="p">:</span>
                <span class="n">intensity_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">intensity_value</span>
            <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">predicted_tuning</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="n">intensity_value</span><span class="p">)</span>

        <span class="c1"># Stack dimensions for correlation computation</span>
        <span class="n">predicted_tuning</span> <span class="o">=</span> <span class="n">predicted_tuning</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stim_dims</span><span class="o">=</span><span class="n">other_dims</span><span class="p">)</span>

        <span class="c1"># Compute correlation</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">predicted_tuning</span><span class="p">,</span> <span class="n">gt_tuning_da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">)</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;stim_dims&#39;</span><span class="p">)</span>
        <span class="n">correlations</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>

    <span class="k">return</span> <span class="n">correlations</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">p</span> <span class="o">=</span> <span class="n">peak_responses</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">p</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (network_id: 2, sample: 48, neuron: 65)&gt;
array([[[1.2707839 , 1.1413251 , 0.87928057, ..., 0.        ,
         0.5582776 , 1.5659437 ],
        [1.2704179 , 1.1411365 , 0.8791765 , ..., 0.        ,
         0.53905785, 1.5659436 ],
        [1.7614158 , 1.6339452 , 1.3735752 , ..., 0.        ,
         0.69133985, 2.3346248 ],
        ...,
        [1.2694845 , 1.1404232 , 0.8785498 , ..., 0.        ,
         0.5668351 , 1.5659437 ],
        [1.7603157 , 1.6335958 , 1.3731476 , ..., 0.        ,
         0.82430005, 2.2795477 ],
        [1.7545149 , 1.6271223 , 1.3670439 , ..., 0.        ,
         0.7924563 , 2.2833645 ]],

       [[0.2344091 , 1.8128183 , 0.35886836, ..., 0.40078512,
         1.4728736 , 0.02466989],
        [0.23360322, 1.807395  , 0.35886833, ..., 0.39070988,
         1.4203595 , 0.02466989],
        [0.75059944, 2.6100328 , 0.77915674, ..., 0.73170674,
         3.045277  , 1.0024749 ],
        ...,
        [0.23270926, 1.8062077 , 0.35837454, ..., 0.39070982,
         1.4639144 , 0.02466999],
        [0.75134325, 2.6244059 , 0.7889573 , ..., 0.68094814,
         3.3359861 , 0.9433924 ],
        [0.7356812 , 2.4753177 , 0.7923856 , ..., 0.5576049 ,
         3.2058313 , 0.9258229 ]]], dtype=float32)
Coordinates:
  * network_id   (network_id) int64 0 1
  * sample       (sample) int64 0 1 2 3 4 5 6 7 8 ... 39 40 41 42 43 44 45 46 47
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7 8 ... 56 57 58 59 60 61 62 63 64
    cell_type    (neuron) &lt;U8 &#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; &#x27;R4&#x27; ... &#x27;TmY14&#x27; &#x27;TmY15&#x27; &#x27;TmY18&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    angle        (sample) int64 0 0 0 0 30 30 30 ... 300 300 300 330 330 330 330
    width        (sample) int64 80 80 80 80 80 80 80 80 ... 80 80 80 80 80 80 80
    intensity    (sample) int64 0 0 1 1 0 0 1 1 0 0 1 ... 0 1 1 0 0 1 1 0 0 1 1
    t_stim       (sample) float64 0.2042 0.1552 0.2042 ... 0.1552 0.2042 0.1552
    speed        (sample) int64 19 25 19 25 19 25 19 25 ... 25 19 25 19 25 19 25
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>sample</span>: 48</li><li><span class='xr-has-index'>neuron</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c5c738db-c5c3-4a9f-8b22-af5f3cf9cd7c' class='xr-array-in' type='checkbox' checked><label for='section-c5c738db-c5c3-4a9f-8b22-af5f3cf9cd7c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.271 1.141 0.8793 1.369 1.681 1.834 ... 1.188 0.0 0.5576 3.206 0.9258</span></div><div class='xr-array-data'><pre>array([[[1.2707839 , 1.1413251 , 0.87928057, ..., 0.        ,
         0.5582776 , 1.5659437 ],
        [1.2704179 , 1.1411365 , 0.8791765 , ..., 0.        ,
         0.53905785, 1.5659436 ],
        [1.7614158 , 1.6339452 , 1.3735752 , ..., 0.        ,
         0.69133985, 2.3346248 ],
        ...,
        [1.2694845 , 1.1404232 , 0.8785498 , ..., 0.        ,
         0.5668351 , 1.5659437 ],
        [1.7603157 , 1.6335958 , 1.3731476 , ..., 0.        ,
         0.82430005, 2.2795477 ],
        [1.7545149 , 1.6271223 , 1.3670439 , ..., 0.        ,
         0.7924563 , 2.2833645 ]],

       [[0.2344091 , 1.8128183 , 0.35886836, ..., 0.40078512,
         1.4728736 , 0.02466989],
        [0.23360322, 1.807395  , 0.35886833, ..., 0.39070988,
         1.4203595 , 0.02466989],
        [0.75059944, 2.6100328 , 0.77915674, ..., 0.73170674,
         3.045277  , 1.0024749 ],
        ...,
        [0.23270926, 1.8062077 , 0.35837454, ..., 0.39070982,
         1.4639144 , 0.02466999],
        [0.75134325, 2.6244059 , 0.7889573 , ..., 0.68094814,
         3.3359861 , 0.9433924 ],
        [0.7356812 , 2.4753177 , 0.7923856 , ..., 0.5576049 ,
         3.2058313 , 0.9258229 ]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-d7400a5b-6135-4254-9265-f4720472b78c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d7400a5b-6135-4254-9265-f4720472b78c' class='xr-section-summary' >Coordinates: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-16deeb32-f8d1-4b2c-98bb-d4762b7d8337' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-16deeb32-f8d1-4b2c-98bb-d4762b7d8337' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49bc6f46-d489-459b-be7c-87c19ead8683' class='xr-var-data-in' type='checkbox'><label for='data-49bc6f46-d489-459b-be7c-87c19ead8683' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 42 43 44 45 46 47</div><input id='attrs-ea45726f-e267-444e-98a8-81955d49a79b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ea45726f-e267-444e-98a8-81955d49a79b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4e3b144-bcbd-487e-8b1c-26cdced8c837' class='xr-var-data-in' type='checkbox'><label for='data-b4e3b144-bcbd-487e-8b1c-26cdced8c837' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-14411a9b-0b93-4e3f-8d20-d34835e199cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-14411a9b-0b93-4e3f-8d20-d34835e199cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-efdcbd0e-8a3b-47d3-b171-619a705c0cbb' class='xr-var-data-in' type='checkbox'><label for='data-efdcbd0e-8a3b-47d3-b171-619a705c0cbb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-b996d746-0768-48fd-8cb5-dd718462c5f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b996d746-0768-48fd-8cb5-dd718462c5f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf5d8a53-51d2-4853-8d05-829865c09269' class='xr-var-data-in' type='checkbox'><label for='data-bf5d8a53-51d2-4853-8d05-829865c09269' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-479559bc-2039-497d-b539-32dab58323d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-479559bc-2039-497d-b539-32dab58323d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ca4441c-293b-45ea-93b9-0ab5e1a9f211' class='xr-var-data-in' type='checkbox'><label for='data-4ca4441c-293b-45ea-93b9-0ab5e1a9f211' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-ece8c1ef-10cc-4b82-ac69-6f177ab20359' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ece8c1ef-10cc-4b82-ac69-6f177ab20359' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9e1ad15-aa97-46ac-a385-1b140fa74675' class='xr-var-data-in' type='checkbox'><label for='data-d9e1ad15-aa97-46ac-a385-1b140fa74675' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 30 ... 300 330 330 330 330</div><input id='attrs-a5ef74ef-66af-434c-b35f-9aab001ce900' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a5ef74ef-66af-434c-b35f-9aab001ce900' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45e443cc-22e0-428b-9849-978b95d49e3c' class='xr-var-data-in' type='checkbox'><label for='data-45e443cc-22e0-428b-9849-978b95d49e3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   0,   0,   0,  30,  30,  30,  30,  60,  60,  60,  60,  90,
        90,  90,  90, 120, 120, 120, 120, 150, 150, 150, 150, 180, 180,
       180, 180, 210, 210, 210, 210, 240, 240, 240, 240, 270, 270, 270,
       270, 300, 300, 300, 300, 330, 330, 330, 330])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80 80 80 80 80 ... 80 80 80 80 80</div><input id='attrs-c260ddc2-1d47-475c-a86d-7f91e1828624' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c260ddc2-1d47-475c-a86d-7f91e1828624' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4ac290d-e153-405c-9a8e-c33193b852e5' class='xr-var-data-in' type='checkbox'><label for='data-e4ac290d-e153-405c-9a8e-c33193b852e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1 0 0 1 1 ... 0 0 1 1 0 0 1 1</div><input id='attrs-76bd1c1a-3fc9-4479-b6f4-e0b7af9fe4b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76bd1c1a-3fc9-4479-b6f4-e0b7af9fe4b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-947cf026-06e1-4b93-9b99-f458d42026e9' class='xr-var-data-in' type='checkbox'><label for='data-947cf026-06e1-4b93-9b99-f458d42026e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0,
       1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1,
       0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_stim</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2042 0.1552 ... 0.2042 0.1552</div><input id='attrs-d3fe46c0-aea9-427c-b2c8-682a6f9389ad' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d3fe46c0-aea9-427c-b2c8-682a6f9389ad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4aa96857-65a7-4d9c-a339-4d38f40904c2' class='xr-var-data-in' type='checkbox'><label for='data-4aa96857-65a7-4d9c-a339-4d38f40904c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>speed</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 25 19 25 19 ... 25 19 25 19 25</div><input id='attrs-862e1165-118f-4d60-9af2-218c238b697f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-862e1165-118f-4d60-9af2-218c238b697f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3dba30b4-7851-4474-9610-5608602cf08c' class='xr-var-data-in' type='checkbox'><label for='data-3dba30b4-7851-4474-9610-5608602cf08c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19,
       25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25,
       19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-e04af205-1272-4641-bead-3b56b1fbd606' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e04af205-1272-4641-bead-3b56b1fbd606' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e9b3130-9bbc-4c5f-90da-822e2236734e' class='xr-var-data-in' type='checkbox'><label for='data-3e9b3130-9bbc-4c5f-90da-822e2236734e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-06834cfa-7fe2-4dfe-9d32-eb4adda15908' class='xr-section-summary-in' type='checkbox'  ><label for='section-06834cfa-7fe2-4dfe-9d32-eb4adda15908' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-367729c2-d54e-4e57-b2d9-6c5dd0acabb5' class='xr-index-data-in' type='checkbox'/><label for='index-367729c2-d54e-4e57-b2d9-6c5dd0acabb5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>sample</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fde979ec-985f-41d6-8310-6f40f2348db1' class='xr-index-data-in' type='checkbox'/><label for='index-fde979ec-985f-41d6-8310-6f40f2348db1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47],
      dtype=&#x27;int64&#x27;, name=&#x27;sample&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c23ee92a-c084-424f-b15b-97c15122dd45' class='xr-index-data-in' type='checkbox'/><label for='index-c23ee92a-c084-424f-b15b-97c15122dd45' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-58e0e4b1-39b1-4dc1-b555-269840431fad' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-58e0e4b1-39b1-4dc1-b555-269840431fad' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_groundtruth_tuning_curves</span><span class="p">(</span><span class="n">cell_types</span><span class="p">,</span> <span class="n">angles</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the ground truth tuning curves for the specified cell types.</span>
<span class="sd">    Optionally interpolates the curves to match the provided angles.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gt_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">tuning_curves</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">cell_type</span> <span class="ow">in</span> <span class="n">cell_types</span><span class="p">:</span>
        <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">groundtruth_utils</span><span class="o">.</span><span class="n">tuning_curves</span><span class="p">[</span><span class="n">cell_type</span><span class="p">]</span>
        <span class="n">interp_func</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">gt_angles</span><span class="p">,</span> <span class="n">gt_tuning</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
        <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">interp_func</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">tuning_curves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gt_tuning</span><span class="p">)</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tuning_curves</span><span class="p">),</span> 
        <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="s1">&#39;angle&#39;</span><span class="p">],</span>
        <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cell_type&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;neuron&quot;</span><span class="p">,</span> <span class="n">cell_types</span><span class="p">),</span> <span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="n">angles</span><span class="p">}</span>
       <span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">maisak_tuning_curve_correlation</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">peak_responses</span> <span class="o">=</span> <span class="n">peak_responses</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">gt_tuning</span> <span class="o">=</span> <span class="n">get_groundtruth_tuning_curves</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;T4a&quot;</span><span class="p">,</span> <span class="s2">&quot;T4b&quot;</span><span class="p">,</span> <span class="s2">&quot;T4c&quot;</span><span class="p">,</span> <span class="s2">&quot;T4d&quot;</span><span class="p">,</span> <span class="s2">&quot;T5a&quot;</span><span class="p">,</span> <span class="s2">&quot;T5b&quot;</span><span class="p">,</span> <span class="s2">&quot;T5c&quot;</span><span class="p">,</span> <span class="s2">&quot;T5d&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">tuning</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">peak_responses</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;speed&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="o">.</span><span class="n">custom</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">cell_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T4a&quot;</span><span class="p">,</span> <span class="s2">&quot;T4b&quot;</span><span class="p">,</span> <span class="s2">&quot;T4c&quot;</span><span class="p">,</span> <span class="s2">&quot;T4d&quot;</span><span class="p">,</span> <span class="s2">&quot;T5a&quot;</span><span class="p">,</span> <span class="s2">&quot;T5b&quot;</span><span class="p">,</span> <span class="s2">&quot;T5c&quot;</span><span class="p">,</span> <span class="s2">&quot;T5d&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># reset the neuron axis to make it compatible with the ground truth tuning curves</span>
    <span class="n">tuning</span><span class="p">[</span><span class="s2">&quot;neuron&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;neuron&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">correlation</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">tuning</span><span class="p">,</span> <span class="n">gt_tuning</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">)</span>
    <span class="n">correlation</span> <span class="o">=</span> <span class="n">correlation</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">correlation</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;speed&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">correlation</span>
    <span class="c1"># T4_correlation = correlation.custom.where(</span>
    <span class="c1">#     cell_type=[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], intensity=1</span>
    <span class="c1"># ).squeeze()</span>
    <span class="c1"># T5_correlation = correlation.custom.where(</span>
    <span class="c1">#     cell_type=[&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;], intensity=0</span>
    <span class="c1"># ).squeeze()</span>
    <span class="c1"># return {&quot;T4&quot;: T4_correlation, &quot;T5&quot;: T5_correlation}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">maisak_tuning_curve_correlation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (network_id: 2, neuron: 8, intensity: 2)&gt;
array([[[-0.52199455,  0.9361876 ],
        [-0.23798394,  0.70642713],
        [-0.38580189,  0.55304839],
        [-0.67519017,  0.8633687 ],
        [ 0.84585357, -0.38946799],
        [ 0.90461177, -0.28886943],
        [ 0.94923338, -0.40776379],
        [ 0.88766108, -0.45659227]],

       [[-0.46044535,  0.94221535],
        [-0.17763585,  0.72580955],
        [-0.29186963,  0.8033357 ],
        [-0.36820605,  0.87244034],
        [ 0.47247743,  0.67372036],
        [ 0.86556892,  0.89139723],
        [ 0.82270961,  0.75211954],
        [ 0.91188945,  0.77480968]]])
Coordinates:
  * intensity    (intensity) int64 0 1
    width        (network_id, neuron, intensity) int64 80 80 80 80 ... 80 80 80
    speed        (network_id, neuron, intensity) int64 19 19 19 19 ... 19 25 25
  * network_id   (network_id) int64 0 1
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7
    cell_type    (neuron) &lt;U8 &#x27;T4a&#x27; &#x27;T4b&#x27; &#x27;T4c&#x27; &#x27;T4d&#x27; &#x27;T5a&#x27; &#x27;T5b&#x27; &#x27;T5c&#x27; &#x27;T5d&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>neuron</span>: 8</li><li><span class='xr-has-index'>intensity</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c2166ad5-8b7a-4886-b365-e0c13217bbfb' class='xr-array-in' type='checkbox' checked><label for='section-c2166ad5-8b7a-4886-b365-e0c13217bbfb' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.522 0.9362 -0.238 0.7064 -0.3858 ... 0.8227 0.7521 0.9119 0.7748</span></div><div class='xr-array-data'><pre>array([[[-0.52199455,  0.9361876 ],
        [-0.23798394,  0.70642713],
        [-0.38580189,  0.55304839],
        [-0.67519017,  0.8633687 ],
        [ 0.84585357, -0.38946799],
        [ 0.90461177, -0.28886943],
        [ 0.94923338, -0.40776379],
        [ 0.88766108, -0.45659227]],

       [[-0.46044535,  0.94221535],
        [-0.17763585,  0.72580955],
        [-0.29186963,  0.8033357 ],
        [-0.36820605,  0.87244034],
        [ 0.47247743,  0.67372036],
        [ 0.86556892,  0.89139723],
        [ 0.82270961,  0.75211954],
        [ 0.91188945,  0.77480968]]])</pre></div></div></li><li class='xr-section-item'><input id='section-69e9bc4d-0b39-49d7-9ea4-cbd18cec59f9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-69e9bc4d-0b39-49d7-9ea4-cbd18cec59f9' class='xr-section-summary' >Coordinates: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>intensity</span></div><div class='xr-var-dims'>(intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-253642a8-bcc5-4344-8d91-629c602fb166' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-253642a8-bcc5-4344-8d91-629c602fb166' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-810a10b9-1c4f-4894-8031-83cebb8cdd97' class='xr-var-data-in' type='checkbox'><label for='data-810a10b9-1c4f-4894-8031-83cebb8cdd97' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>(network_id, neuron, intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80 80 80 80 80 ... 80 80 80 80 80</div><input id='attrs-533ddf04-991f-406e-9bc9-7f16b56a6d6d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-533ddf04-991f-406e-9bc9-7f16b56a6d6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc8c9752-f15a-4d84-82ff-131b2b350a18' class='xr-var-data-in' type='checkbox'><label for='data-bc8c9752-f15a-4d84-82ff-131b2b350a18' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80]],

       [[80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80],
        [80, 80]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>speed</span></div><div class='xr-var-dims'>(network_id, neuron, intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 19 19 19 19 ... 19 25 19 25 25</div><input id='attrs-08c72f9f-1afd-47e4-a58c-532936ff13b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-08c72f9f-1afd-47e4-a58c-532936ff13b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83aa108d-c534-4618-b962-f515ac415a39' class='xr-var-data-in' type='checkbox'><label for='data-83aa108d-c534-4618-b962-f515ac415a39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[19, 19],
        [19, 19],
        [19, 19],
        [19, 19],
        [19, 19],
        [19, 19],
        [19, 19],
        [19, 19]],

       [[19, 19],
        [19, 19],
        [19, 19],
        [25, 19],
        [19, 19],
        [25, 19],
        [25, 19],
        [25, 25]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-e968bd9d-1ce8-4ac8-a390-e9a019f960bb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e968bd9d-1ce8-4ac8-a390-e9a019f960bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21041629-255f-471e-a183-52df38fb4c80' class='xr-var-data-in' type='checkbox'><label for='data-21041629-255f-471e-a183-52df38fb4c80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7</div><input id='attrs-7b9e0dfc-a0af-4013-a2e8-0f5f0a31aea4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b9e0dfc-a0af-4013-a2e8-0f5f0a31aea4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b3bef97-5f5c-4fd3-af74-fb8a1eb05f09' class='xr-var-data-in' type='checkbox'><label for='data-9b3bef97-5f5c-4fd3-af74-fb8a1eb05f09' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;T4a&#x27; &#x27;T4b&#x27; &#x27;T4c&#x27; ... &#x27;T5c&#x27; &#x27;T5d&#x27;</div><input id='attrs-3a72cf70-5d77-4d19-bded-4dabb8ff1d47' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a72cf70-5d77-4d19-bded-4dabb8ff1d47' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-110b061b-0706-430a-ab0b-a8d131fa3dc6' class='xr-var-data-in' type='checkbox'><label for='data-110b061b-0706-430a-ab0b-a8d131fa3dc6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;T4a&#x27;, &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;],
      dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0</div><input id='attrs-4a784950-cc13-467f-911b-ce447c7e7c40' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4a784950-cc13-467f-911b-ce447c7e7c40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23f8d17f-df92-4ae7-9923-e5fe822fbebf' class='xr-var-data-in' type='checkbox'><label for='data-23f8d17f-df92-4ae7-9923-e5fe822fbebf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0</div><input id='attrs-67da69ef-43b1-4512-b85e-64ace1f416de' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67da69ef-43b1-4512-b85e-64ace1f416de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11b5dc16-b6dd-42e1-aeab-8c380e90e0a8' class='xr-var-data-in' type='checkbox'><label for='data-11b5dc16-b6dd-42e1-aeab-8c380e90e0a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-4bb1fbd6-96fd-4332-adfa-8eaddf8e2ded' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4bb1fbd6-96fd-4332-adfa-8eaddf8e2ded' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7ca5567-6a4f-452d-b02e-69cca1556582' class='xr-var-data-in' type='checkbox'><label for='data-e7ca5567-6a4f-452d-b02e-69cca1556582' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f2c5434b-cc39-43b4-a638-53323d18c93e' class='xr-section-summary-in' type='checkbox'  ><label for='section-f2c5434b-cc39-43b4-a638-53323d18c93e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>intensity</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-01c6cf15-0ec9-4f5f-a6dd-c2e75de4a244' class='xr-index-data-in' type='checkbox'/><label for='index-01c6cf15-0ec9-4f5f-a6dd-c2e75de4a244' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;intensity&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-05c3de25-050f-4d9b-a7b0-4c9ef7dd60e7' class='xr-index-data-in' type='checkbox'/><label for='index-05c3de25-050f-4d9b-a7b0-4c9ef7dd60e7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c78f2961-ffc2-4874-a9c8-d0287c9d450e' class='xr-index-data-in' type='checkbox'/><label for='index-c78f2961-ffc2-4874-a9c8-d0287c9d450e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7], dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4225227f-3473-401a-b8f4-a962f4f1b866' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4225227f-3473-401a-b8f4-a962f4f1b866' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T5_correlation</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;speed&quot;</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (network_id: 2, neuron: 4, intensity: 1, width: 1)&gt;
array([[[[0.84585357]],

        [[0.90461177]],

        [[0.94923338]],

        [[0.88766108]]],


       [[[0.47247743]],

        [[0.86556892]],

        [[0.82270961]],

        [[0.91188945]]]])
Coordinates:
  * intensity    (intensity) int64 0
  * width        (width) int64 80
  * network_id   (network_id) int64 0 1
  * neuron       (neuron) int64 4 5 6 7
    cell_type    (neuron) &lt;U8 &#x27;T5a&#x27; &#x27;T5b&#x27; &#x27;T5c&#x27; &#x27;T5d&#x27;
    u            (neuron) int32 0 0 0 0
    v            (neuron) int32 0 0 0 0
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>neuron</span>: 4</li><li><span class='xr-has-index'>intensity</span>: 1</li><li><span class='xr-has-index'>width</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2e56c736-906c-4d8b-a1c6-2917bf0c5895' class='xr-array-in' type='checkbox' checked><label for='section-2e56c736-906c-4d8b-a1c6-2917bf0c5895' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.8459 0.9046 0.9492 0.8877 0.4725 0.8656 0.8227 0.9119</span></div><div class='xr-array-data'><pre>array([[[[0.84585357]],

        [[0.90461177]],

        [[0.94923338]],

        [[0.88766108]]],


       [[[0.47247743]],

        [[0.86556892]],

        [[0.82270961]],

        [[0.91188945]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-e0de9d13-e7bc-4aca-9ddd-6ba894f3632f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e0de9d13-e7bc-4aca-9ddd-6ba894f3632f' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>intensity</span></div><div class='xr-var-dims'>(intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-7ed46bf1-58ba-4377-a5fb-ca3371fcd2e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ed46bf1-58ba-4377-a5fb-ca3371fcd2e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34f1271e-e8d6-4a89-b3ed-126aaa885104' class='xr-var-data-in' type='checkbox'><label for='data-34f1271e-e8d6-4a89-b3ed-126aaa885104' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>width</span></div><div class='xr-var-dims'>(width)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80</div><input id='attrs-3906e942-5556-49a1-95df-270844e43ced' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3906e942-5556-49a1-95df-270844e43ced' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77971593-782c-4a02-afd1-cef52113650e' class='xr-var-data-in' type='checkbox'><label for='data-77971593-782c-4a02-afd1-cef52113650e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-9ed8862a-1f51-468a-8c78-cbdfd1aa5ffb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9ed8862a-1f51-468a-8c78-cbdfd1aa5ffb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c76b944e-e638-4ee4-965e-95465ee816dd' class='xr-var-data-in' type='checkbox'><label for='data-c76b944e-e638-4ee4-965e-95465ee816dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>4 5 6 7</div><input id='attrs-f5ce5eca-f38f-40f5-aaa9-8289079a6f05' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f5ce5eca-f38f-40f5-aaa9-8289079a6f05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb204dbf-e3ae-4196-a8bc-03eebcb6a9cc' class='xr-var-data-in' type='checkbox'><label for='data-eb204dbf-e3ae-4196-a8bc-03eebcb6a9cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([4, 5, 6, 7])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;T5a&#x27; &#x27;T5b&#x27; &#x27;T5c&#x27; &#x27;T5d&#x27;</div><input id='attrs-651e6df1-f113-4537-a84a-a88910433f7d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-651e6df1-f113-4537-a84a-a88910433f7d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-112cc42d-74fe-45cf-b6a9-39140f32f5a7' class='xr-var-data-in' type='checkbox'><label for='data-112cc42d-74fe-45cf-b6a9-39140f32f5a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0</div><input id='attrs-90cc3952-6e12-4dd2-a80b-b00db2ad746d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-90cc3952-6e12-4dd2-a80b-b00db2ad746d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-809def47-678d-4ec7-9ea4-d7798e2b918d' class='xr-var-data-in' type='checkbox'><label for='data-809def47-678d-4ec7-9ea4-d7798e2b918d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0</div><input id='attrs-553154db-e0cb-4da3-977b-ad23d6aa1600' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-553154db-e0cb-4da3-977b-ad23d6aa1600' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0612e1cb-5a75-4619-9f88-38c501d750f3' class='xr-var-data-in' type='checkbox'><label for='data-0612e1cb-5a75-4619-9f88-38c501d750f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-97f61eac-57dd-4bb2-afdd-418e0a3b5fff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-97f61eac-57dd-4bb2-afdd-418e0a3b5fff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c06533c-595e-4a60-bff1-4f1a0aa1cf84' class='xr-var-data-in' type='checkbox'><label for='data-3c06533c-595e-4a60-bff1-4f1a0aa1cf84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-12bfd4f9-de10-40c5-b354-661aa2435ec6' class='xr-section-summary-in' type='checkbox'  ><label for='section-12bfd4f9-de10-40c5-b354-661aa2435ec6' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>intensity</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2bb6cc95-0251-43ed-b5aa-cffe9a453f5c' class='xr-index-data-in' type='checkbox'/><label for='index-2bb6cc95-0251-43ed-b5aa-cffe9a453f5c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0], dtype=&#x27;int64&#x27;, name=&#x27;intensity&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>width</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0a6060e6-adbe-41f8-af25-bac6fb71180f' class='xr-index-data-in' type='checkbox'/><label for='index-0a6060e6-adbe-41f8-af25-bac6fb71180f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([80], dtype=&#x27;int64&#x27;, name=&#x27;width&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-85b0650f-3d05-4dc6-9b75-c737b3f7f8ce' class='xr-index-data-in' type='checkbox'/><label for='index-85b0650f-3d05-4dc6-9b75-c737b3f7f8ce' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8e308f73-668c-4d99-9922-f6cd477fd1fd' class='xr-index-data-in' type='checkbox'/><label for='index-8e308f73-668c-4d99-9922-f6cd477fd1fd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([4, 5, 6, 7], dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3e1cae5e-13cf-4f76-a2ef-50407e098d32' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3e1cae5e-13cf-4f76-a2ef-50407e098d32' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">angles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tuning</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">get_groundtruth_tuning_curves</span><span class="p">([</span><span class="s1">&#39;T4a&#39;</span><span class="p">,</span> <span class="s1">&#39;T4b&#39;</span><span class="p">,</span> <span class="s1">&#39;T4c&#39;</span><span class="p">,</span> <span class="s1">&#39;T4d&#39;</span><span class="p">,</span> <span class="s1">&#39;T5a&#39;</span><span class="p">,</span> <span class="s1">&#39;T5b&#39;</span><span class="p">,</span> <span class="s1">&#39;T5c&#39;</span><span class="p">,</span> <span class="s1">&#39;T5d&#39;</span><span class="p">],</span> <span class="n">angles</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

Input In [469], in &lt;cell line: 1&gt;()
----&gt; 1 get_groundtruth_tuning_curves([&#39;T4a&#39;, &#39;T4b&#39;, &#39;T4c&#39;, &#39;T4d&#39;, &#39;T5a&#39;, &#39;T5b&#39;, &#39;T5c&#39;, &#39;T5d&#39;], angles)


Input In [468], in get_groundtruth_tuning_curves(cell_types, angles)
     14     gt_tuning = interp_func(angles)
     15     tuning_curves.append(gt_tuning)
---&gt; 17 dataset = xr.Dataset(tuning_curves, 
     18                      coords={&#39;cell_type&#39;: cell_types, &#39;angle&#39;: angles}
     19                      )
     21 return dataset


File ~/miniconda3/envs/flyvision/lib/python3.9/site-packages/xarray/core/dataset.py:643, in Dataset.__init__(self, data_vars, coords, attrs)
    640 if coords is None:
    641     coords = {}
--&gt; 643 both_data_and_coords = set(data_vars) &amp; set(coords)
    644 if both_data_and_coords:
    645     raise ValueError(
    646         f&quot;variables {both_data_and_coords!r} are found in both data_vars and coords&quot;
    647     )


TypeError: unhashable type: &#39;numpy.ndarray&#39;
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">p</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (network_id: 2, sample: 48, neuron: 65)&gt;
array([[[1.2707839 , 1.1413251 , 0.87928057, ..., 0.        ,
         0.5582776 , 1.5659437 ],
        [1.2704179 , 1.1411365 , 0.8791765 , ..., 0.        ,
         0.53905785, 1.5659436 ],
        [1.7614158 , 1.6339452 , 1.3735752 , ..., 0.        ,
         0.69133985, 2.3346248 ],
        ...,
        [1.2694845 , 1.1404232 , 0.8785498 , ..., 0.        ,
         0.5668351 , 1.5659437 ],
        [1.7603157 , 1.6335958 , 1.3731476 , ..., 0.        ,
         0.82430005, 2.2795477 ],
        [1.7545149 , 1.6271223 , 1.3670439 , ..., 0.        ,
         0.7924563 , 2.2833645 ]],

       [[0.2344091 , 1.8128183 , 0.35886836, ..., 0.40078512,
         1.4728736 , 0.02466989],
        [0.23360322, 1.807395  , 0.35886833, ..., 0.39070988,
         1.4203595 , 0.02466989],
        [0.75059944, 2.6100328 , 0.77915674, ..., 0.73170674,
         3.045277  , 1.0024749 ],
        ...,
        [0.23270926, 1.8062077 , 0.35837454, ..., 0.39070982,
         1.4639144 , 0.02466999],
        [0.75134325, 2.6244059 , 0.7889573 , ..., 0.68094814,
         3.3359861 , 0.9433924 ],
        [0.7356812 , 2.4753177 , 0.7923856 , ..., 0.5576049 ,
         3.2058313 , 0.9258229 ]]], dtype=float32)
Coordinates:
  * network_id   (network_id) int64 0 1
  * sample       (sample) int64 0 1 2 3 4 5 6 7 8 ... 39 40 41 42 43 44 45 46 47
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7 8 ... 56 57 58 59 60 61 62 63 64
    cell_type    (neuron) &lt;U8 &#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; &#x27;R4&#x27; ... &#x27;TmY14&#x27; &#x27;TmY15&#x27; &#x27;TmY18&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    angle        (sample) int64 0 0 0 0 30 30 30 ... 300 300 300 330 330 330 330
    width        (sample) int64 80 80 80 80 80 80 80 80 ... 80 80 80 80 80 80 80
    intensity    (sample) int64 0 0 1 1 0 0 1 1 0 0 1 ... 0 1 1 0 0 1 1 0 0 1 1
    t_stim       (sample) float64 0.2042 0.1552 0.2042 ... 0.1552 0.2042 0.1552
    speed        (sample) int64 19 25 19 25 19 25 19 25 ... 25 19 25 19 25 19 25
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>sample</span>: 48</li><li><span class='xr-has-index'>neuron</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a50940dd-f1ad-44e5-8955-25689b6924ba' class='xr-array-in' type='checkbox' checked><label for='section-a50940dd-f1ad-44e5-8955-25689b6924ba' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.271 1.141 0.8793 1.369 1.681 1.834 ... 1.188 0.0 0.5576 3.206 0.9258</span></div><div class='xr-array-data'><pre>array([[[1.2707839 , 1.1413251 , 0.87928057, ..., 0.        ,
         0.5582776 , 1.5659437 ],
        [1.2704179 , 1.1411365 , 0.8791765 , ..., 0.        ,
         0.53905785, 1.5659436 ],
        [1.7614158 , 1.6339452 , 1.3735752 , ..., 0.        ,
         0.69133985, 2.3346248 ],
        ...,
        [1.2694845 , 1.1404232 , 0.8785498 , ..., 0.        ,
         0.5668351 , 1.5659437 ],
        [1.7603157 , 1.6335958 , 1.3731476 , ..., 0.        ,
         0.82430005, 2.2795477 ],
        [1.7545149 , 1.6271223 , 1.3670439 , ..., 0.        ,
         0.7924563 , 2.2833645 ]],

       [[0.2344091 , 1.8128183 , 0.35886836, ..., 0.40078512,
         1.4728736 , 0.02466989],
        [0.23360322, 1.807395  , 0.35886833, ..., 0.39070988,
         1.4203595 , 0.02466989],
        [0.75059944, 2.6100328 , 0.77915674, ..., 0.73170674,
         3.045277  , 1.0024749 ],
        ...,
        [0.23270926, 1.8062077 , 0.35837454, ..., 0.39070982,
         1.4639144 , 0.02466999],
        [0.75134325, 2.6244059 , 0.7889573 , ..., 0.68094814,
         3.3359861 , 0.9433924 ],
        [0.7356812 , 2.4753177 , 0.7923856 , ..., 0.5576049 ,
         3.2058313 , 0.9258229 ]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-3c327f6a-5956-4182-b653-35090fa394d1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3c327f6a-5956-4182-b653-35090fa394d1' class='xr-section-summary' >Coordinates: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-0c4039ad-b700-4139-b341-dda650342e93' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0c4039ad-b700-4139-b341-dda650342e93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57bfb550-bf6f-48e4-a73c-cac12e086cfe' class='xr-var-data-in' type='checkbox'><label for='data-57bfb550-bf6f-48e4-a73c-cac12e086cfe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 42 43 44 45 46 47</div><input id='attrs-4428232c-d76e-45d4-9317-c916dc5c48a4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4428232c-d76e-45d4-9317-c916dc5c48a4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba33deb7-43cf-4af8-84f1-50cc631dfd91' class='xr-var-data-in' type='checkbox'><label for='data-ba33deb7-43cf-4af8-84f1-50cc631dfd91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-de573e45-a41d-43a4-8c89-6b45f38f81ae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de573e45-a41d-43a4-8c89-6b45f38f81ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31a49142-84c4-44c4-a904-c1d00dad2fa0' class='xr-var-data-in' type='checkbox'><label for='data-31a49142-84c4-44c4-a904-c1d00dad2fa0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-29f3aa06-c0c8-421e-99d1-8123642a6f64' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-29f3aa06-c0c8-421e-99d1-8123642a6f64' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6835180a-eda1-4809-9302-23b8b06d1e5f' class='xr-var-data-in' type='checkbox'><label for='data-6835180a-eda1-4809-9302-23b8b06d1e5f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-c76d1893-d1cc-4d54-9da4-92702b115ded' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c76d1893-d1cc-4d54-9da4-92702b115ded' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72d8fa90-bdc3-49e2-8d60-e8938f170737' class='xr-var-data-in' type='checkbox'><label for='data-72d8fa90-bdc3-49e2-8d60-e8938f170737' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-2c5ad9ed-3bc6-4bd4-8c9e-6ecd9c302b38' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2c5ad9ed-3bc6-4bd4-8c9e-6ecd9c302b38' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fbb750a-b92b-4269-8ab5-c4e857ccaa73' class='xr-var-data-in' type='checkbox'><label for='data-5fbb750a-b92b-4269-8ab5-c4e857ccaa73' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 30 ... 300 330 330 330 330</div><input id='attrs-beb304a3-749e-4b3f-9975-49047b50d101' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-beb304a3-749e-4b3f-9975-49047b50d101' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24594cd0-ae46-4961-8dc6-4184ca3c466e' class='xr-var-data-in' type='checkbox'><label for='data-24594cd0-ae46-4961-8dc6-4184ca3c466e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   0,   0,   0,  30,  30,  30,  30,  60,  60,  60,  60,  90,
        90,  90,  90, 120, 120, 120, 120, 150, 150, 150, 150, 180, 180,
       180, 180, 210, 210, 210, 210, 240, 240, 240, 240, 270, 270, 270,
       270, 300, 300, 300, 300, 330, 330, 330, 330])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80 80 80 80 80 ... 80 80 80 80 80</div><input id='attrs-67cac6e5-22d8-4676-8358-51e0a34acf1e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67cac6e5-22d8-4676-8358-51e0a34acf1e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d149ff34-51db-47c4-8763-789122fc865f' class='xr-var-data-in' type='checkbox'><label for='data-d149ff34-51db-47c4-8763-789122fc865f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1 0 0 1 1 ... 0 0 1 1 0 0 1 1</div><input id='attrs-2adc8748-68ea-487c-b0e5-e6eea3408538' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2adc8748-68ea-487c-b0e5-e6eea3408538' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8b9a652-be10-4874-82e2-0ec54b51eec5' class='xr-var-data-in' type='checkbox'><label for='data-e8b9a652-be10-4874-82e2-0ec54b51eec5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0,
       1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1,
       0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_stim</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2042 0.1552 ... 0.2042 0.1552</div><input id='attrs-30c5ee4e-e5fc-47b5-ae05-53be20f341a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-30c5ee4e-e5fc-47b5-ae05-53be20f341a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26de6f17-9389-4a5e-9eb4-1a8b3025bf25' class='xr-var-data-in' type='checkbox'><label for='data-26de6f17-9389-4a5e-9eb4-1a8b3025bf25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>speed</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 25 19 25 19 ... 25 19 25 19 25</div><input id='attrs-051e257c-de91-4653-ba28-e0cc4a76eb58' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-051e257c-de91-4653-ba28-e0cc4a76eb58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42ed7b7f-925c-41fd-a65e-414ea95f7979' class='xr-var-data-in' type='checkbox'><label for='data-42ed7b7f-925c-41fd-a65e-414ea95f7979' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19,
       25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25,
       19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-88e282df-e110-4781-b5e3-63142089d912' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-88e282df-e110-4781-b5e3-63142089d912' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d972c6e5-5f4f-449d-b9d3-ee2387865e9f' class='xr-var-data-in' type='checkbox'><label for='data-d972c6e5-5f4f-449d-b9d3-ee2387865e9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f3cf8805-76b3-446c-9573-3428ca0e1255' class='xr-section-summary-in' type='checkbox'  ><label for='section-f3cf8805-76b3-446c-9573-3428ca0e1255' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d4073891-06dc-408e-9a86-f008dd1ca8cd' class='xr-index-data-in' type='checkbox'/><label for='index-d4073891-06dc-408e-9a86-f008dd1ca8cd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>sample</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d3c78771-657f-4b60-8717-9ce63c91b166' class='xr-index-data-in' type='checkbox'/><label for='index-d3c78771-657f-4b60-8717-9ce63c91b166' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47],
      dtype=&#x27;int64&#x27;, name=&#x27;sample&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d2dbeb65-4a41-4559-869a-928eac8bb453' class='xr-index-data-in' type='checkbox'/><label for='index-d2dbeb65-4a41-4559-869a-928eac8bb453' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-583d6ae1-ce55-4dcd-8395-b9bf631d004a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-583d6ae1-ce55-4dcd-8395-b9bf631d004a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">dsi</span> <span class="o">=</span> <span class="n">direction_selectivity_index</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">a</span> <span class="o">=</span> <span class="n">dsi_correlation_to_known</span><span class="p">(</span><span class="n">dsi</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">a</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (network_id: 2, intensity: 2, speed: 2)&gt;
array([[[0.65186982, 0.62478615],
        [0.5719433 , 0.52512768]],

       [[0.49935473, 0.40968303],
        [0.57014632, 0.57931699]]])
Coordinates:
    width        int64 80
  * intensity    (intensity) int64 0 1
  * speed        (speed) int64 19 25
  * network_id   (network_id) int64 0 1
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>intensity</span>: 2</li><li><span class='xr-has-index'>speed</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-505390ae-e5c9-4e93-8f67-6f8fe563aa98' class='xr-array-in' type='checkbox' checked><label for='section-505390ae-e5c9-4e93-8f67-6f8fe563aa98' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.6519 0.6248 0.5719 0.5251 0.4994 0.4097 0.5701 0.5793</span></div><div class='xr-array-data'><pre>array([[[0.65186982, 0.62478615],
        [0.5719433 , 0.52512768]],

       [[0.49935473, 0.40968303],
        [0.57014632, 0.57931699]]])</pre></div></div></li><li class='xr-section-item'><input id='section-7495d5b0-46d5-410c-98fc-5a0818de24e9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7495d5b0-46d5-410c-98fc-5a0818de24e9' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80</div><input id='attrs-d8af7d7b-5c27-4b21-b540-4182e7985d56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d8af7d7b-5c27-4b21-b540-4182e7985d56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e68e58da-3f3a-43d8-9ab2-ca42f434ef9d' class='xr-var-data-in' type='checkbox'><label for='data-e68e58da-3f3a-43d8-9ab2-ca42f434ef9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(80)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>intensity</span></div><div class='xr-var-dims'>(intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-ec1c216b-980d-4e39-813f-eae72ec3bdee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec1c216b-980d-4e39-813f-eae72ec3bdee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6f326a6-5789-4f5e-aaa3-171e23024762' class='xr-var-data-in' type='checkbox'><label for='data-c6f326a6-5789-4f5e-aaa3-171e23024762' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>speed</span></div><div class='xr-var-dims'>(speed)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 25</div><input id='attrs-f31f6f66-b436-41bf-b445-e852af7a75e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f31f6f66-b436-41bf-b445-e852af7a75e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1da4b86e-88ac-4894-bdde-6a59edb635ee' class='xr-var-data-in' type='checkbox'><label for='data-1da4b86e-88ac-4894-bdde-6a59edb635ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-e25543bf-59fb-4ce9-a43c-c99510ffceed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e25543bf-59fb-4ce9-a43c-c99510ffceed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d843c78-bb72-47e2-90f7-218c60bbacc6' class='xr-var-data-in' type='checkbox'><label for='data-4d843c78-bb72-47e2-90f7-218c60bbacc6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-3c69e661-0c8f-4194-bce7-f2bc5d5afd7c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c69e661-0c8f-4194-bce7-f2bc5d5afd7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7190d2a2-3f41-4189-bd1d-aad06492f487' class='xr-var-data-in' type='checkbox'><label for='data-7190d2a2-3f41-4189-bd1d-aad06492f487' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1d40e511-5202-4f00-92f3-5e8e7b1036f0' class='xr-section-summary-in' type='checkbox'  ><label for='section-1d40e511-5202-4f00-92f3-5e8e7b1036f0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>intensity</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1c5a7d04-9ce2-460a-a836-ae4ef220475f' class='xr-index-data-in' type='checkbox'/><label for='index-1c5a7d04-9ce2-460a-a836-ae4ef220475f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;intensity&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>speed</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0cc1e2ca-bef1-4f8c-bc19-0ec8d858cb22' class='xr-index-data-in' type='checkbox'/><label for='index-0cc1e2ca-bef1-4f8c-bc19-0ec8d858cb22' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([19, 25], dtype=&#x27;int64&#x27;, name=&#x27;speed&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8a463fa6-f4a7-4ba3-a076-6d7f1a52e38b' class='xr-index-data-in' type='checkbox'/><label for='index-8a463fa6-f4a7-4ba3-a076-6d7f1a52e38b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-452934b4-8d6d-4e7f-a717-612dd40d9e77' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-452934b4-8d6d-4e7f-a717-612dd40d9e77' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">peak_responses_angular</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (network_id: 2, sample: 48, neuron: 65)&gt;
array([[[1.2707839 +0.j        , 1.14132512+0.j        ,
         0.87928057+0.j        , ..., 0.        +0.j        ,
         0.55827761+0.j        , 1.56594372+0.j        ],
        [1.27041793+0.j        , 1.14113653+0.j        ,
         0.8791765 +0.j        , ..., 0.        +0.j        ,
         0.53905785+0.j        , 1.5659436 +0.j        ],
        [1.76141584+0.j        , 1.63394523+0.j        ,
         1.37357521+0.j        , ..., 0.        +0.j        ,
         0.69133985+0.j        , 2.33462477+0.j        ],
        ...,
        [1.09940584-0.63474226j, 0.98763544-0.57021159j,
         0.76084646-0.43927491j, ..., 0.        +0.j        ,
         0.4908936 -0.28341755j, 1.35614704-0.78297186j],
        [1.52447808-0.88015783j, 1.41473548-0.81679791j,
         1.18918071-0.6865738j , ..., 0.        +0.j        ,
         0.71386478-0.41215003j, 1.97414621-1.13977385j],
        [1.5194545 -0.87725747j, 1.40912923-0.81356114j,
         1.1838947 -0.68352193j, ..., 0.        +0.j        ,
         0.68628731-0.39622816j, 1.97745169-1.14168227j]],

       [[0.23440909+0.j        , 1.81281829+0.j        ,
         0.35886836+0.j        , ..., 0.40078512+0.j        ,
         1.47287357+0.j        , 0.02466989+0.j        ],
        [0.23360322+0.j        , 1.80739498+0.j        ,
         0.35886833+0.j        , ..., 0.39070988+0.j        ,
         1.42035949+0.j        , 0.02466989+0.j        ],
        [0.75059944+0.j        , 2.6100328 +0.j        ,
         0.77915674+0.j        , ..., 0.73170674+0.j        ,
         3.04527712+0.j        , 1.0024749 +0.j        ],
        ...,
        [0.20153213-0.11635463j, 1.56422172-0.90310383j,
         0.31036145-0.17918727j, ..., 0.33836463-0.19535491j,
         1.26778705-0.7319572j , 0.02136484-0.01233499j],
        [0.65068234-0.37567163j, 2.27280215-1.31220293j,
         0.68325706-0.39447865j, ..., 0.58971839-0.34047407j,
         2.88904874-1.66799307j, 0.81700178-0.4716962j ],
        [0.63711859-0.36784059j, 2.14368803-1.23765886j,
         0.68622604-0.39619279j, ..., 0.48290002-0.27880245j,
         2.77633134-1.60291564j, 0.80178616-0.46291146j]]])
Coordinates:
  * network_id   (network_id) int64 0 1
  * sample       (sample) int64 0 1 2 3 4 5 6 7 8 ... 39 40 41 42 43 44 45 46 47
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7 8 ... 56 57 58 59 60 61 62 63 64
    cell_type    (neuron) &lt;U8 &#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; &#x27;R4&#x27; ... &#x27;TmY14&#x27; &#x27;TmY15&#x27; &#x27;TmY18&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    angle        (sample) int64 0 0 0 0 30 30 30 ... 300 300 300 330 330 330 330
    width        (sample) int64 80 80 80 80 80 80 80 80 ... 80 80 80 80 80 80 80
    intensity    (sample) int64 0 0 1 1 0 0 1 1 0 0 1 ... 0 1 1 0 0 1 1 0 0 1 1
    t_stim       (sample) float64 0.2042 0.1552 0.2042 ... 0.1552 0.2042 0.1552
    speed        (sample) int64 19 25 19 25 19 25 19 25 ... 25 19 25 19 25 19 25
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>sample</span>: 48</li><li><span class='xr-has-index'>neuron</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-6b8275e9-6b04-440d-ad1c-2785a05cdfc5' class='xr-array-in' type='checkbox' checked><label for='section-6b8275e9-6b04-440d-ad1c-2785a05cdfc5' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>(1.2707839012145996+0j) ... (0.8017861626237669-0.4629114568233494j)</span></div><div class='xr-array-data'><pre>array([[[1.2707839 +0.j        , 1.14132512+0.j        ,
         0.87928057+0.j        , ..., 0.        +0.j        ,
         0.55827761+0.j        , 1.56594372+0.j        ],
        [1.27041793+0.j        , 1.14113653+0.j        ,
         0.8791765 +0.j        , ..., 0.        +0.j        ,
         0.53905785+0.j        , 1.5659436 +0.j        ],
        [1.76141584+0.j        , 1.63394523+0.j        ,
         1.37357521+0.j        , ..., 0.        +0.j        ,
         0.69133985+0.j        , 2.33462477+0.j        ],
        ...,
        [1.09940584-0.63474226j, 0.98763544-0.57021159j,
         0.76084646-0.43927491j, ..., 0.        +0.j        ,
         0.4908936 -0.28341755j, 1.35614704-0.78297186j],
        [1.52447808-0.88015783j, 1.41473548-0.81679791j,
         1.18918071-0.6865738j , ..., 0.        +0.j        ,
         0.71386478-0.41215003j, 1.97414621-1.13977385j],
        [1.5194545 -0.87725747j, 1.40912923-0.81356114j,
         1.1838947 -0.68352193j, ..., 0.        +0.j        ,
         0.68628731-0.39622816j, 1.97745169-1.14168227j]],

       [[0.23440909+0.j        , 1.81281829+0.j        ,
         0.35886836+0.j        , ..., 0.40078512+0.j        ,
         1.47287357+0.j        , 0.02466989+0.j        ],
        [0.23360322+0.j        , 1.80739498+0.j        ,
         0.35886833+0.j        , ..., 0.39070988+0.j        ,
         1.42035949+0.j        , 0.02466989+0.j        ],
        [0.75059944+0.j        , 2.6100328 +0.j        ,
         0.77915674+0.j        , ..., 0.73170674+0.j        ,
         3.04527712+0.j        , 1.0024749 +0.j        ],
        ...,
        [0.20153213-0.11635463j, 1.56422172-0.90310383j,
         0.31036145-0.17918727j, ..., 0.33836463-0.19535491j,
         1.26778705-0.7319572j , 0.02136484-0.01233499j],
        [0.65068234-0.37567163j, 2.27280215-1.31220293j,
         0.68325706-0.39447865j, ..., 0.58971839-0.34047407j,
         2.88904874-1.66799307j, 0.81700178-0.4716962j ],
        [0.63711859-0.36784059j, 2.14368803-1.23765886j,
         0.68622604-0.39619279j, ..., 0.48290002-0.27880245j,
         2.77633134-1.60291564j, 0.80178616-0.46291146j]]])</pre></div></div></li><li class='xr-section-item'><input id='section-fb8a26f4-1a68-4a38-9a36-91d58a5aa38a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fb8a26f4-1a68-4a38-9a36-91d58a5aa38a' class='xr-section-summary' >Coordinates: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-3cbfc638-752a-4b51-8b6c-cdd5b2cbf5c3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3cbfc638-752a-4b51-8b6c-cdd5b2cbf5c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1128ccc6-0f4d-4d7e-b274-e269b8efd6bf' class='xr-var-data-in' type='checkbox'><label for='data-1128ccc6-0f4d-4d7e-b274-e269b8efd6bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 42 43 44 45 46 47</div><input id='attrs-38afc429-101d-47a2-b9d6-2e17165794b3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-38afc429-101d-47a2-b9d6-2e17165794b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39e479fc-2c7c-4303-b350-39e8658fe8f8' class='xr-var-data-in' type='checkbox'><label for='data-39e479fc-2c7c-4303-b350-39e8658fe8f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-190a2955-d318-48ff-bab3-9b44daa7f0b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-190a2955-d318-48ff-bab3-9b44daa7f0b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7ee531f-d51f-4e0b-957e-126b857019cd' class='xr-var-data-in' type='checkbox'><label for='data-a7ee531f-d51f-4e0b-957e-126b857019cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-7e0a1521-eff9-44c5-819b-1fbd8b391738' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e0a1521-eff9-44c5-819b-1fbd8b391738' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75e0d5ed-7e99-4adb-9d99-d83f3e690f8a' class='xr-var-data-in' type='checkbox'><label for='data-75e0d5ed-7e99-4adb-9d99-d83f3e690f8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-2b3c10d7-d6a1-4acc-99ac-5371a008d621' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2b3c10d7-d6a1-4acc-99ac-5371a008d621' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7469e496-407c-47b8-b241-6c7359bcba3a' class='xr-var-data-in' type='checkbox'><label for='data-7469e496-407c-47b8-b241-6c7359bcba3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-6990fdb1-47fe-4b76-a678-dd63c30f4ea4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6990fdb1-47fe-4b76-a678-dd63c30f4ea4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34233c8f-ec61-41f6-ac2b-cb2d01e85654' class='xr-var-data-in' type='checkbox'><label for='data-34233c8f-ec61-41f6-ac2b-cb2d01e85654' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 30 ... 300 330 330 330 330</div><input id='attrs-f1ef53e6-cff6-43ac-a8dc-ad9dfd7e7e0d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f1ef53e6-cff6-43ac-a8dc-ad9dfd7e7e0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a3d11dd-cc16-4125-97ca-ba06c1e6b693' class='xr-var-data-in' type='checkbox'><label for='data-2a3d11dd-cc16-4125-97ca-ba06c1e6b693' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   0,   0,   0,  30,  30,  30,  30,  60,  60,  60,  60,  90,
        90,  90,  90, 120, 120, 120, 120, 150, 150, 150, 150, 180, 180,
       180, 180, 210, 210, 210, 210, 240, 240, 240, 240, 270, 270, 270,
       270, 300, 300, 300, 300, 330, 330, 330, 330])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80 80 80 80 80 ... 80 80 80 80 80</div><input id='attrs-4ee75b94-ccdc-4b89-b9c7-e1ccbb2160c0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ee75b94-ccdc-4b89-b9c7-e1ccbb2160c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d45012a9-1612-4ffa-afad-126a3f660a54' class='xr-var-data-in' type='checkbox'><label for='data-d45012a9-1612-4ffa-afad-126a3f660a54' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1 0 0 1 1 ... 0 0 1 1 0 0 1 1</div><input id='attrs-efc61cca-da54-456a-a595-6c86ab8c531a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-efc61cca-da54-456a-a595-6c86ab8c531a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a776f62a-9832-4ee5-bf87-b8c8d6aef023' class='xr-var-data-in' type='checkbox'><label for='data-a776f62a-9832-4ee5-bf87-b8c8d6aef023' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0,
       1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1,
       0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_stim</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2042 0.1552 ... 0.2042 0.1552</div><input id='attrs-85ed21dc-26b9-49a3-b56f-adb807c36856' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-85ed21dc-26b9-49a3-b56f-adb807c36856' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec0baa7d-1364-4c7c-a354-989a6583c21f' class='xr-var-data-in' type='checkbox'><label for='data-ec0baa7d-1364-4c7c-a354-989a6583c21f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>speed</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 25 19 25 19 ... 25 19 25 19 25</div><input id='attrs-7f855007-b7f3-4536-aa47-2830e6bf5ae3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7f855007-b7f3-4536-aa47-2830e6bf5ae3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc71f9f1-b718-44ae-ad18-6f03a92c4c06' class='xr-var-data-in' type='checkbox'><label for='data-fc71f9f1-b718-44ae-ad18-6f03a92c4c06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19,
       25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25,
       19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-02bdc82b-db27-428b-b254-20e96251ce19' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-02bdc82b-db27-428b-b254-20e96251ce19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f2eb2eb-ee92-4454-8534-24c09ce3629e' class='xr-var-data-in' type='checkbox'><label for='data-6f2eb2eb-ee92-4454-8534-24c09ce3629e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2d7875e7-8389-41b6-9088-ce7796c1c6b4' class='xr-section-summary-in' type='checkbox'  ><label for='section-2d7875e7-8389-41b6-9088-ce7796c1c6b4' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-aeeb607b-3326-42c6-98a8-be2dd87378a7' class='xr-index-data-in' type='checkbox'/><label for='index-aeeb607b-3326-42c6-98a8-be2dd87378a7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>sample</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-efbd4e00-599f-475c-8788-cd76226a4e9d' class='xr-index-data-in' type='checkbox'/><label for='index-efbd4e00-599f-475c-8788-cd76226a4e9d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47],
      dtype=&#x27;int64&#x27;, name=&#x27;sample&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3305c57f-4331-405a-a27e-3ba32536d66f' class='xr-index-data-in' type='checkbox'/><label for='index-3305c57f-4331-405a-a27e-3ba32536d66f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-19da7bab-9530-4bc0-b01b-448f2b3646c6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-19da7bab-9530-4bc0-b01b-448f2b3646c6' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">plot_T4_tuning</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../xarrayjoblib_files/xarrayjoblib_40_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">plot_T5_tuning</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../xarrayjoblib_files/xarrayjoblib_41_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">q</span> <span class="o">=</span> <span class="n">plot_angular_tuning</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cell_type</span><span class="o">=</span><span class="s2">&quot;T4c&quot;</span><span class="p">,</span> <span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="n">average_models</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p><img alt="png" src="../xarrayjoblib_files/xarrayjoblib_42_0.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">r</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (sample: 48, frame: 440, channel: 1, hex_pixel: 721,
                  network_id: 2, neuron: 65)
Coordinates: (12/18)
  * network_id   (network_id) int64 0 1
  * sample       (sample) int64 0 1 2 3 4 5 6 7 8 ... 39 40 41 42 43 44 45 46 47
  * frame        (frame) int64 0 1 2 3 4 5 6 7 ... 433 434 435 436 437 438 439
    time         (frame) float64 -1.0 -0.995 -0.99 -0.985 ... 1.185 1.19 1.195
  * channel      (channel) int64 0
  * hex_pixel    (hex_pixel) int64 0 1 2 3 4 5 6 ... 714 715 716 717 718 719 720
    ...           ...
    angle        (sample) int64 0 0 0 0 30 30 30 ... 300 300 300 330 330 330 330
    width        (sample) int64 80 80 80 80 80 80 80 80 ... 80 80 80 80 80 80 80
    intensity    (sample) int64 0 0 1 1 0 0 1 1 0 0 1 ... 0 1 1 0 0 1 1 0 0 1 1
    t_stim       (sample) float64 0.2042 0.1552 0.2042 ... 0.1552 0.2042 0.1552
    speed        (sample) int64 19 25 19 25 19 25 19 25 ... 25 19 25 19 25 19 25
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...
Data variables:
    stimulus     (sample, frame, channel, hex_pixel) float64 0.5 0.5 ... nan nan
    responses    (network_id, sample, frame, neuron) float32 1.27 1.141 ... nan
Attributes:
    config:          {&#x27;offsets&#x27;: (-5, 5), &#x27;intensities&#x27;: [0, 1], &#x27;speeds&#x27;: [1...
    network_config:  {&#x27;connectome&#x27;: {&#x27;type&#x27;: &#x27;ConnectomeDir&#x27;, &#x27;file&#x27;: &#x27;fib25-...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3e9b63dd-fa5a-4420-9e5a-e89708e78cbf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3e9b63dd-fa5a-4420-9e5a-e89708e78cbf' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>sample</span>: 48</li><li><span class='xr-has-index'>frame</span>: 440</li><li><span class='xr-has-index'>channel</span>: 1</li><li><span class='xr-has-index'>hex_pixel</span>: 721</li><li><span class='xr-has-index'>network_id</span>: 2</li><li><span class='xr-has-index'>neuron</span>: 65</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c7c06885-c505-4ffe-ba58-751fad2a5205' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c7c06885-c505-4ffe-ba58-751fad2a5205' class='xr-section-summary' >Coordinates: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-579dc009-9928-4ef3-a4b1-422444463d8f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-579dc009-9928-4ef3-a4b1-422444463d8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71532258-d7a4-4dde-87a2-e520bac426af' class='xr-var-data-in' type='checkbox'><label for='data-71532258-d7a4-4dde-87a2-e520bac426af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 42 43 44 45 46 47</div><input id='attrs-552e978b-efac-4d8f-807e-f012e44d6450' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-552e978b-efac-4d8f-807e-f012e44d6450' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-65c76532-023a-4bc6-967d-2b81a3811726' class='xr-var-data-in' type='checkbox'><label for='data-65c76532-023a-4bc6-967d-2b81a3811726' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 435 436 437 438 439</div><input id='attrs-24fab08f-b701-4531-8ad9-d9ae95ad4196' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-24fab08f-b701-4531-8ad9-d9ae95ad4196' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f171793-c6e7-4b6f-872d-6e8268f4c7fc' class='xr-var-data-in' type='checkbox'><label for='data-4f171793-c6e7-4b6f-872d-6e8268f4c7fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 437, 438, 439])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -0.995 -0.99 ... 1.19 1.195</div><input id='attrs-f57e4196-c938-4757-8e0a-f6a31b1a4621' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f57e4196-c938-4757-8e0a-f6a31b1a4621' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02bd7e4f-c6cf-454e-97c8-6528f652fd1a' class='xr-var-data-in' type='checkbox'><label for='data-02bd7e4f-c6cf-454e-97c8-6528f652fd1a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.   , -0.995, -0.99 , -0.985, -0.98 , -0.975, -0.97 , -0.965,
       -0.96 , -0.955, -0.95 , -0.945, -0.94 , -0.935, -0.93 , -0.925,
       -0.92 , -0.915, -0.91 , -0.905, -0.9  , -0.895, -0.89 , -0.885,
       -0.88 , -0.875, -0.87 , -0.865, -0.86 , -0.855, -0.85 , -0.845,
       -0.84 , -0.835, -0.83 , -0.825, -0.82 , -0.815, -0.81 , -0.805,
       -0.8  , -0.795, -0.79 , -0.785, -0.78 , -0.775, -0.77 , -0.765,
       -0.76 , -0.755, -0.75 , -0.745, -0.74 , -0.735, -0.73 , -0.725,
       -0.72 , -0.715, -0.71 , -0.705, -0.7  , -0.695, -0.69 , -0.685,
       -0.68 , -0.675, -0.67 , -0.665, -0.66 , -0.655, -0.65 , -0.645,
       -0.64 , -0.635, -0.63 , -0.625, -0.62 , -0.615, -0.61 , -0.605,
       -0.6  , -0.595, -0.59 , -0.585, -0.58 , -0.575, -0.57 , -0.565,
       -0.56 , -0.555, -0.55 , -0.545, -0.54 , -0.535, -0.53 , -0.525,
       -0.52 , -0.515, -0.51 , -0.505, -0.5  , -0.495, -0.49 , -0.485,
       -0.48 , -0.475, -0.47 , -0.465, -0.46 , -0.455, -0.45 , -0.445,
       -0.44 , -0.435, -0.43 , -0.425, -0.42 , -0.415, -0.41 , -0.405,
       -0.4  , -0.395, -0.39 , -0.385, -0.38 , -0.375, -0.37 , -0.365,
       -0.36 , -0.355, -0.35 , -0.345, -0.34 , -0.335, -0.33 , -0.325,
       -0.32 , -0.315, -0.31 , -0.305, -0.3  , -0.295, -0.29 , -0.285,
       -0.28 , -0.275, -0.27 , -0.265, -0.26 , -0.255, -0.25 , -0.245,
       -0.24 , -0.235, -0.23 , -0.225, -0.22 , -0.215, -0.21 , -0.205,
...
        0.4  ,  0.405,  0.41 ,  0.415,  0.42 ,  0.425,  0.43 ,  0.435,
        0.44 ,  0.445,  0.45 ,  0.455,  0.46 ,  0.465,  0.47 ,  0.475,
        0.48 ,  0.485,  0.49 ,  0.495,  0.5  ,  0.505,  0.51 ,  0.515,
        0.52 ,  0.525,  0.53 ,  0.535,  0.54 ,  0.545,  0.55 ,  0.555,
        0.56 ,  0.565,  0.57 ,  0.575,  0.58 ,  0.585,  0.59 ,  0.595,
        0.6  ,  0.605,  0.61 ,  0.615,  0.62 ,  0.625,  0.63 ,  0.635,
        0.64 ,  0.645,  0.65 ,  0.655,  0.66 ,  0.665,  0.67 ,  0.675,
        0.68 ,  0.685,  0.69 ,  0.695,  0.7  ,  0.705,  0.71 ,  0.715,
        0.72 ,  0.725,  0.73 ,  0.735,  0.74 ,  0.745,  0.75 ,  0.755,
        0.76 ,  0.765,  0.77 ,  0.775,  0.78 ,  0.785,  0.79 ,  0.795,
        0.8  ,  0.805,  0.81 ,  0.815,  0.82 ,  0.825,  0.83 ,  0.835,
        0.84 ,  0.845,  0.85 ,  0.855,  0.86 ,  0.865,  0.87 ,  0.875,
        0.88 ,  0.885,  0.89 ,  0.895,  0.9  ,  0.905,  0.91 ,  0.915,
        0.92 ,  0.925,  0.93 ,  0.935,  0.94 ,  0.945,  0.95 ,  0.955,
        0.96 ,  0.965,  0.97 ,  0.975,  0.98 ,  0.985,  0.99 ,  0.995,
        1.   ,  1.005,  1.01 ,  1.015,  1.02 ,  1.025,  1.03 ,  1.035,
        1.04 ,  1.045,  1.05 ,  1.055,  1.06 ,  1.065,  1.07 ,  1.075,
        1.08 ,  1.085,  1.09 ,  1.095,  1.1  ,  1.105,  1.11 ,  1.115,
        1.12 ,  1.125,  1.13 ,  1.135,  1.14 ,  1.145,  1.15 ,  1.155,
        1.16 ,  1.165,  1.17 ,  1.175,  1.18 ,  1.185,  1.19 ,  1.195])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>channel</span></div><div class='xr-var-dims'>(channel)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-696063bd-810f-4143-a8fa-d8f728522a86' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-696063bd-810f-4143-a8fa-d8f728522a86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34260b85-75ac-48e5-b043-c2c78ae9c998' class='xr-var-data-in' type='checkbox'><label for='data-34260b85-75ac-48e5-b043-c2c78ae9c998' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>hex_pixel</span></div><div class='xr-var-dims'>(hex_pixel)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 716 717 718 719 720</div><input id='attrs-9a31d798-7d2a-4886-b9ac-a12facc07e6c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a31d798-7d2a-4886-b9ac-a12facc07e6c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8310d59e-bd2d-4b68-bc1a-d6134feeed24' class='xr-var-data-in' type='checkbox'><label for='data-8310d59e-bd2d-4b68-bc1a-d6134feeed24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 718, 719, 720])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u_in</span></div><div class='xr-var-dims'>(hex_pixel)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>-15 -15 -15 -15 -15 ... 15 15 15 15</div><input id='attrs-08636bea-12c6-4924-9668-f8e037b190bf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-08636bea-12c6-4924-9668-f8e037b190bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5f76855-51a3-4b17-9792-43d14d131c1d' class='xr-var-data-in' type='checkbox'><label for='data-c5f76855-51a3-4b17-9792-43d14d131c1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15, -15,
       -15, -15, -15, -14, -14, -14, -14, -14, -14, -14, -14, -14, -14,
       -14, -14, -14, -14, -14, -14, -14, -13, -13, -13, -13, -13, -13,
       -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -13, -12,
       -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12, -12,
       -12, -12, -12, -12, -12, -11, -11, -11, -11, -11, -11, -11, -11,
       -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -11, -10,
       -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10, -10,
       -10, -10, -10, -10, -10, -10, -10,  -9,  -9,  -9,  -9,  -9,  -9,
        -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,  -9,
        -9,  -9,  -9,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,
        -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,  -8,
        -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,
        -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -7,  -6,  -6,
        -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,
        -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -6,  -5,  -5,  -5,
        -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,
        -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -5,  -4,  -4,  -4,
        -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,
        -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -4,  -3,  -3,
...
         4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,
         4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5,   5,
         5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,
         5,   5,   5,   5,   5,   5,   5,   5,   5,   6,   6,   6,   6,
         6,   6,   6,   6,   6,   6,   6,   6,   6,   6,   6,   6,   6,
         6,   6,   6,   6,   6,   6,   6,   6,   7,   7,   7,   7,   7,
         7,   7,   7,   7,   7,   7,   7,   7,   7,   7,   7,   7,   7,
         7,   7,   7,   7,   7,   7,   8,   8,   8,   8,   8,   8,   8,
         8,   8,   8,   8,   8,   8,   8,   8,   8,   8,   8,   8,   8,
         8,   8,   8,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,
         9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,  10,
        10,  10,  10,  10,  10,  10,  10,  10,  10,  10,  10,  10,  10,
        10,  10,  10,  10,  10,  10,  10,  11,  11,  11,  11,  11,  11,
        11,  11,  11,  11,  11,  11,  11,  11,  11,  11,  11,  11,  11,
        11,  12,  12,  12,  12,  12,  12,  12,  12,  12,  12,  12,  12,
        12,  12,  12,  12,  12,  12,  12,  13,  13,  13,  13,  13,  13,
        13,  13,  13,  13,  13,  13,  13,  13,  13,  13,  13,  13,  14,
        14,  14,  14,  14,  14,  14,  14,  14,  14,  14,  14,  14,  14,
        14,  14,  14,  15,  15,  15,  15,  15,  15,  15,  15,  15,  15,
        15,  15,  15,  15,  15,  15], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_in</span></div><div class='xr-var-dims'>(hex_pixel)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... -5 -4 -3 -2 -1 0</div><input id='attrs-95bb6b01-1040-4d65-8dfd-c07181c396e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-95bb6b01-1040-4d65-8dfd-c07181c396e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-33abfe2f-15cd-43fc-b8b8-be77cbcbdbe4' class='xr-var-data-in' type='checkbox'><label for='data-33abfe2f-15cd-43fc-b8b8-be77cbcbdbe4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  -1,   0,   1,   2,   3,   4,   5,   6,   7,   8,
         9,  10,  11,  12,  13,  14,  15,  -2,  -1,   0,   1,   2,   3,
         4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  -3,
        -2,  -1,   0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,
        11,  12,  13,  14,  15,  -4,  -3,  -2,  -1,   0,   1,   2,   3,
         4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  -5,
        -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,   5,   6,   7,   8,
         9,  10,  11,  12,  13,  14,  15,  -6,  -5,  -4,  -3,  -2,  -1,
         0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,
         3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,
        -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,
         5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  -9,  -8,
        -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,   5,
         6,   7,   8,   9,  10,  11,  12,  13,  14,  15, -10,  -9,  -8,
        -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,   5,
         6,   7,   8,   9,  10,  11,  12,  13,  14,  15, -11, -10,  -9,
        -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,
         5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15, -12, -11,
...
       -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,
         3,   4,   5,   6,   7,   8,   9,  10,  11, -15, -14, -13, -12,
       -11, -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,
         2,   3,   4,   5,   6,   7,   8,   9,  10, -15, -14, -13, -12,
       -11, -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,
         2,   3,   4,   5,   6,   7,   8,   9, -15, -14, -13, -12, -11,
       -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,
         3,   4,   5,   6,   7,   8, -15, -14, -13, -12, -11, -10,  -9,
        -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,
         5,   6,   7, -15, -14, -13, -12, -11, -10,  -9,  -8,  -7,  -6,
        -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,   4,   5,   6, -15,
       -14, -13, -12, -11, -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,
        -1,   0,   1,   2,   3,   4,   5, -15, -14, -13, -12, -11, -10,
        -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2,   3,
         4, -15, -14, -13, -12, -11, -10,  -9,  -8,  -7,  -6,  -5,  -4,
        -3,  -2,  -1,   0,   1,   2,   3, -15, -14, -13, -12, -11, -10,
        -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,  -1,   0,   1,   2, -15,
       -14, -13, -12, -11, -10,  -9,  -8,  -7,  -6,  -5,  -4,  -3,  -2,
        -1,   0,   1, -15, -14, -13, -12, -11, -10,  -9,  -8,  -7,  -6,
        -5,  -4,  -3,  -2,  -1,   0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-56f10b9d-339c-4f50-9964-0f8d6e8225cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-56f10b9d-339c-4f50-9964-0f8d6e8225cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81c86c75-a1b4-4bf7-8c3f-2dcfe473faa9' class='xr-var-data-in' type='checkbox'><label for='data-81c86c75-a1b4-4bf7-8c3f-2dcfe473faa9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-77ecd573-74c3-4375-b0ce-159e8760940a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77ecd573-74c3-4375-b0ce-159e8760940a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc588fcf-d96c-4880-8627-36189fc6b9d7' class='xr-var-data-in' type='checkbox'><label for='data-dc588fcf-d96c-4880-8627-36189fc6b9d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-7b28efb2-1708-41e0-9c84-b64d9633d8a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b28efb2-1708-41e0-9c84-b64d9633d8a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9678977-f322-444a-9529-c2b6b4912277' class='xr-var-data-in' type='checkbox'><label for='data-a9678977-f322-444a-9529-c2b6b4912277' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-1acd09e2-dd5e-421a-969a-dc950e940ce6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1acd09e2-dd5e-421a-969a-dc950e940ce6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d87116b-03eb-4c50-87d0-c51c83a8f536' class='xr-var-data-in' type='checkbox'><label for='data-5d87116b-03eb-4c50-87d0-c51c83a8f536' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>angle</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 30 ... 300 330 330 330 330</div><input id='attrs-1e023719-8243-464d-88fe-51b6dbf1f12a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e023719-8243-464d-88fe-51b6dbf1f12a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1158a71-a38d-4277-9eb4-29165f069abb' class='xr-var-data-in' type='checkbox'><label for='data-d1158a71-a38d-4277-9eb4-29165f069abb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   0,   0,   0,  30,  30,  30,  30,  60,  60,  60,  60,  90,
        90,  90,  90, 120, 120, 120, 120, 150, 150, 150, 150, 180, 180,
       180, 180, 210, 210, 210, 210, 240, 240, 240, 240, 270, 270, 270,
       270, 300, 300, 300, 300, 330, 330, 330, 330])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>width</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80 80 80 80 80 ... 80 80 80 80 80</div><input id='attrs-28c2050c-f331-436d-8d11-b3f3f7e80ec0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-28c2050c-f331-436d-8d11-b3f3f7e80ec0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-207cce34-aae0-4905-abdb-9b6c64d1bd2f' class='xr-var-data-in' type='checkbox'><label for='data-207cce34-aae0-4905-abdb-9b6c64d1bd2f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80,
       80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1 0 0 1 1 ... 0 0 1 1 0 0 1 1</div><input id='attrs-55712aa3-9cc5-4ea1-b580-f0278d941bcf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-55712aa3-9cc5-4ea1-b580-f0278d941bcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a863f83a-7629-4aa7-9301-ec1676838f62' class='xr-var-data-in' type='checkbox'><label for='data-a863f83a-7629-4aa7-9301-ec1676838f62' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0,
       1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1,
       0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_stim</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2042 0.1552 ... 0.2042 0.1552</div><input id='attrs-dc786320-1f81-4104-841b-f5255c284331' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dc786320-1f81-4104-841b-f5255c284331' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-164632e0-40c8-41df-a77b-8f89b04b3bf2' class='xr-var-data-in' type='checkbox'><label for='data-164632e0-40c8-41df-a77b-8f89b04b3bf2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241, 0.20417423, 0.15517241,
       0.20417423, 0.15517241, 0.20417423, 0.15517241, 0.20417423,
       0.15517241, 0.20417423, 0.15517241])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>speed</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>19 25 19 25 19 ... 25 19 25 19 25</div><input id='attrs-e3e8c930-e1af-49f7-8bd6-eb3c6bab30de' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3e8c930-e1af-49f7-8bd6-eb3c6bab30de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef2f7e86-84d3-4d06-90e7-07ea9295ee0f' class='xr-var-data-in' type='checkbox'><label for='data-ef2f7e86-84d3-4d06-90e7-07ea9295ee0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19,
       25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25,
       19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25, 19, 25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-ca612a54-6c00-4895-abcb-761dddd2d909' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca612a54-6c00-4895-abcb-761dddd2d909' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3be4ac5b-6b7c-4917-ab96-ee98063b3f24' class='xr-var-data-in' type='checkbox'><label for='data-3be4ac5b-6b7c-4917-ab96-ee98063b3f24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a1ac0858-3ca5-4938-8b93-187ea90cf03c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a1ac0858-3ca5-4938-8b93-187ea90cf03c' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>stimulus</span></div><div class='xr-var-dims'>(sample, frame, channel, hex_pixel)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5 0.5 0.5 0.5 ... nan nan nan nan</div><input id='attrs-5cbbd35c-659c-4c2a-ba4d-4fed7b1f5897' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5cbbd35c-659c-4c2a-ba4d-4fed7b1f5897' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-964fe858-afa3-4428-8c9d-10b40f1d2b7d' class='xr-var-data-in' type='checkbox'><label for='data-964fe858-afa3-4428-8c9d-10b40f1d2b7d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        [[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        [[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        ...,

        [[0.        , 0.        , 0.47431193, ..., 0.        ,
          0.        , 0.        ]],

        [[0.        , 0.        , 0.47431193, ..., 0.        ,
          0.        , 0.        ]],

        [[0.        , 0.        , 0.47431193, ..., 0.        ,
          0.        , 0.        ]]],

...

       [[[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        [[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        [[0.5       , 0.5       , 0.5       , ..., 0.5       ,
          0.5       , 0.5       ]],

        ...,

        [[       nan,        nan,        nan, ...,        nan,
                 nan,        nan]],

        [[       nan,        nan,        nan, ...,        nan,
                 nan,        nan]],

        [[       nan,        nan,        nan, ...,        nan,
                 nan,        nan]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>responses</span></div><div class='xr-var-dims'>(network_id, sample, frame, neuron)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.27 1.141 0.8791 ... nan nan nan</div><input id='attrs-326536e5-510f-4a18-b522-3fefeee5ece6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-326536e5-510f-4a18-b522-3fefeee5ece6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d134953-cddf-4c0b-a64f-7b5a6232d3e3' class='xr-var-data-in' type='checkbox'><label for='data-1d134953-cddf-4c0b-a64f-7b5a6232d3e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 1.2699827e+00,  1.1409136e+00,  8.7905246e-01, ...,
          -6.6536027e-01,  4.8437607e-01,  1.5647463e+00],
         [ 1.2699821e+00,  1.1409132e+00,  8.7905228e-01, ...,
          -6.6528553e-01,  4.8435861e-01,  1.5648680e+00],
         [ 1.2699815e+00,  1.1409129e+00,  8.7905210e-01, ...,
          -6.6521347e-01,  4.8434174e-01,  1.5649835e+00],
         ...,
         [ 7.7462441e-01,  6.4331424e-01,  3.8036552e-01, ...,
          -5.7851070e-01,  5.2488267e-01,  1.2676799e+00],
         [ 7.7462435e-01,  6.4331424e-01,  3.8036549e-01, ...,
          -5.7848930e-01,  5.2487588e-01,  1.2676859e+00],
         [ 7.7462429e-01,  6.4331424e-01,  3.8036549e-01, ...,
          -5.7846826e-01,  5.2486914e-01,  1.2676917e+00]],

        [[ 1.2699827e+00,  1.1409136e+00,  8.7905246e-01, ...,
          -6.6536027e-01,  4.8437607e-01,  1.5647463e+00],
         [ 1.2699821e+00,  1.1409132e+00,  8.7905228e-01, ...,
          -6.6528553e-01,  4.8435861e-01,  1.5648680e+00],
         [ 1.2699815e+00,  1.1409129e+00,  8.7905210e-01, ...,
          -6.6521347e-01,  4.8434174e-01,  1.5649835e+00],
...
           1.3832799e+00,  3.3471973e+00, -8.2388854e-01],
         [ 8.2881838e-01,  3.7831399e+00,  8.0427933e-01, ...,
           1.3832707e+00,  3.3472531e+00, -8.2382894e-01],
         [ 8.2882798e-01,  3.7832930e+00,  8.0428213e-01, ...,
           1.3832619e+00,  3.3473077e+00, -8.2377064e-01]],

        [[ 2.2684795e-01,  1.7318463e+00,  3.6645707e-01, ...,
           4.3895900e-01,  1.1567652e+00, -9.4679988e-04],
         [ 2.2692201e-01,  1.7327036e+00,  3.6635238e-01, ...,
           4.3843845e-01,  1.1580265e+00, -8.0603233e-04],
         [ 2.2699524e-01,  1.7335522e+00,  3.6624962e-01, ...,
           4.3793163e-01,  1.1592617e+00, -6.6797069e-04],
         ...,
         [           nan,            nan,            nan, ...,
                     nan,            nan,            nan],
         [           nan,            nan,            nan, ...,
                     nan,            nan,            nan],
         [           nan,            nan,            nan, ...,
                     nan,            nan,            nan]]]],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4d524c0b-7536-49dc-b380-258b17a4e4ad' class='xr-section-summary-in' type='checkbox'  ><label for='section-4d524c0b-7536-49dc-b380-258b17a4e4ad' class='xr-section-summary' >Indexes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-051e335c-257d-47d6-9523-c8046d9c482a' class='xr-index-data-in' type='checkbox'/><label for='index-051e335c-257d-47d6-9523-c8046d9c482a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>sample</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4f1d0e5b-629d-4f2c-bcf5-6dc53c849160' class='xr-index-data-in' type='checkbox'/><label for='index-4f1d0e5b-629d-4f2c-bcf5-6dc53c849160' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47],
      dtype=&#x27;int64&#x27;, name=&#x27;sample&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>frame</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4a03289c-13d8-48a0-8fe0-f42d75c92c64' class='xr-index-data-in' type='checkbox'/><label for='index-4a03289c-13d8-48a0-8fe0-f42d75c92c64' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       430, 431, 432, 433, 434, 435, 436, 437, 438, 439],
      dtype=&#x27;int64&#x27;, name=&#x27;frame&#x27;, length=440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>channel</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9d8e7842-2691-47b7-ac0c-813657aa25f7' class='xr-index-data-in' type='checkbox'/><label for='index-9d8e7842-2691-47b7-ac0c-813657aa25f7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0], dtype=&#x27;int64&#x27;, name=&#x27;channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>hex_pixel</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d0a024c2-fc8e-4774-aaaa-1b477eafc1b9' class='xr-index-data-in' type='checkbox'/><label for='index-d0a024c2-fc8e-4774-aaaa-1b477eafc1b9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       711, 712, 713, 714, 715, 716, 717, 718, 719, 720],
      dtype=&#x27;int64&#x27;, name=&#x27;hex_pixel&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-85ce5c6e-b79b-4270-8d6c-3edd578dfbe8' class='xr-index-data-in' type='checkbox'/><label for='index-85ce5c6e-b79b-4270-8d6c-3edd578dfbe8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-538f1611-de28-459d-9130-097d4c976552' class='xr-section-summary-in' type='checkbox'  checked><label for='section-538f1611-de28-459d-9130-097d4c976552' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>config :</span></dt><dd>{&#x27;offsets&#x27;: (-5, 5), &#x27;intensities&#x27;: [0, 1], &#x27;speeds&#x27;: [19, 25], &#x27;height&#x27;: 80, &#x27;post_pad_mode&#x27;: &#x27;continue&#x27;, &#x27;dt&#x27;: 0.005, &#x27;device&#x27;: &#x27;cuda&#x27;, &#x27;t_pre&#x27;: 1.0, &#x27;t_post&#x27;: 1.0}</dd><dt><span>network_config :</span></dt><dd>{&#x27;connectome&#x27;: {&#x27;type&#x27;: &#x27;ConnectomeDir&#x27;, &#x27;file&#x27;: &#x27;fib25-fib19_v2.2.json&#x27;, &#x27;extent&#x27;: 15, &#x27;n_syn_fill&#x27;: 1}, &#x27;dynamics&#x27;: {&#x27;type&#x27;: &#x27;PPNeuronIGRSynapses&#x27;, &#x27;activation&#x27;: {&#x27;type&#x27;: &#x27;relu&#x27;}}, &#x27;node_config&#x27;: {&#x27;bias&#x27;: {&#x27;type&#x27;: &#x27;RestingPotential&#x27;, &#x27;groupby&#x27;: [&#x27;type&#x27;], &#x27;initial_dist&#x27;: &#x27;Normal&#x27;, &#x27;mode&#x27;: &#x27;sample&#x27;, &#x27;requires_grad&#x27;: True, &#x27;mean&#x27;: 0.5, &#x27;std&#x27;: 0.05, &#x27;penalize&#x27;: {&#x27;activity&#x27;: True}, &#x27;seed&#x27;: 0}, &#x27;time_const&#x27;: {&#x27;type&#x27;: &#x27;TimeConstant&#x27;, &#x27;groupby&#x27;: [&#x27;type&#x27;], &#x27;initial_dist&#x27;: &#x27;Value&#x27;, &#x27;value&#x27;: 0.05, &#x27;requires_grad&#x27;: True}}, &#x27;edge_config&#x27;: {&#x27;sign&#x27;: {&#x27;type&#x27;: &#x27;SynapseSign&#x27;, &#x27;initial_dist&#x27;: &#x27;Value&#x27;, &#x27;requires_grad&#x27;: False, &#x27;groupby&#x27;: [&#x27;source_type&#x27;, &#x27;target_type&#x27;]}, &#x27;syn_count&#x27;: {&#x27;type&#x27;: &#x27;SynapseCount&#x27;, &#x27;initial_dist&#x27;: &#x27;Lognormal&#x27;, &#x27;mode&#x27;: &#x27;mean&#x27;, &#x27;requires_grad&#x27;: False, &#x27;std&#x27;: 1.0, &#x27;groupby&#x27;: [&#x27;source_type&#x27;, &#x27;target_type&#x27;, &#x27;du&#x27;, &#x27;dv&#x27;]}, &#x27;syn_strength&#x27;: {&#x27;type&#x27;: &#x27;SynapseCountScaling&#x27;, &#x27;initial_dist&#x27;: &#x27;Value&#x27;, &#x27;requires_grad&#x27;: True, &#x27;scale_elec&#x27;: 0.01, &#x27;scale_chem&#x27;: 0.01, &#x27;clamp&#x27;: &#x27;non_negative&#x27;, &#x27;groupby&#x27;: [&#x27;source_type&#x27;, &#x27;target_type&#x27;, &#x27;edge_type&#x27;]}}}</dd></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">q</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (neuron: 1, angle: 12, width: 1, intensity: 1)&gt;
array([[[[1.11791303]],

        [[1.85500802]],

        [[2.40902067]],

        [[2.3863104 ]],

        [[1.98378356]],

        [[1.2498901 ]],

        [[0.27551793]],

        [[0.10736401]],

        [[0.11013283]],

        [[0.11038107]],

        [[0.11502841]],

        [[0.44682346]]]])
Coordinates:
  * angle      (angle) int64 0 30 60 90 120 150 180 210 240 270 300 330
  * width      (width) int64 80
  * intensity  (intensity) int64 1
  * neuron     (neuron) int64 37
    cell_type  (neuron) &lt;U8 &#x27;T4c&#x27;
    u          (neuron) int32 0
    v          (neuron) int32 0
    quantile   float64 0.95</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>neuron</span>: 1</li><li><span class='xr-has-index'>angle</span>: 12</li><li><span class='xr-has-index'>width</span>: 1</li><li><span class='xr-has-index'>intensity</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-88b67806-b6b2-4e1e-94c8-8deb203059e9' class='xr-array-in' type='checkbox' checked><label for='section-88b67806-b6b2-4e1e-94c8-8deb203059e9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.118 1.855 2.409 2.386 1.984 ... 0.1074 0.1101 0.1104 0.115 0.4468</span></div><div class='xr-array-data'><pre>array([[[[1.11791303]],

        [[1.85500802]],

        [[2.40902067]],

        [[2.3863104 ]],

        [[1.98378356]],

        [[1.2498901 ]],

        [[0.27551793]],

        [[0.10736401]],

        [[0.11013283]],

        [[0.11038107]],

        [[0.11502841]],

        [[0.44682346]]]])</pre></div></div></li><li class='xr-section-item'><input id='section-cfbe4a25-e259-4a2a-aaf6-f0bd6bc95222' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cfbe4a25-e259-4a2a-aaf6-f0bd6bc95222' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>angle</span></div><div class='xr-var-dims'>(angle)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 30 60 90 120 ... 240 270 300 330</div><input id='attrs-44abbed9-bf2c-4b34-8c35-de6ee7e3b139' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44abbed9-bf2c-4b34-8c35-de6ee7e3b139' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8dd17116-efb2-4cf7-989d-1a3f61fe294a' class='xr-var-data-in' type='checkbox'><label for='data-8dd17116-efb2-4cf7-989d-1a3f61fe294a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,  30,  60,  90, 120, 150, 180, 210, 240, 270, 300, 330])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>width</span></div><div class='xr-var-dims'>(width)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>80</div><input id='attrs-dabe162e-64fa-4715-8990-a9e765f6decc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dabe162e-64fa-4715-8990-a9e765f6decc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9401399f-c381-4ea2-b889-d27b180a8694' class='xr-var-data-in' type='checkbox'><label for='data-9401399f-c381-4ea2-b889-d27b180a8694' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([80])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>intensity</span></div><div class='xr-var-dims'>(intensity)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-de69a154-c34e-4129-8192-8fa831d93ec7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de69a154-c34e-4129-8192-8fa831d93ec7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2751bf2-98fa-4518-afb3-cb752794eb53' class='xr-var-data-in' type='checkbox'><label for='data-b2751bf2-98fa-4518-afb3-cb752794eb53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>37</div><input id='attrs-4cb371e6-2f3f-46f8-b532-8967e306bd89' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4cb371e6-2f3f-46f8-b532-8967e306bd89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72257a5a-74df-4b04-a9f3-2a53e04b60b5' class='xr-var-data-in' type='checkbox'><label for='data-72257a5a-74df-4b04-a9f3-2a53e04b60b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([37])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;T4c&#x27;</div><input id='attrs-3feed2a0-b504-422d-95cd-2f5c0cbfb75a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3feed2a0-b504-422d-95cd-2f5c0cbfb75a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-303bb512-73ae-4038-ab21-244eaaed1f4e' class='xr-var-data-in' type='checkbox'><label for='data-303bb512-73ae-4038-ab21-244eaaed1f4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;T4c&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-5ba19970-d037-466e-84ed-d30385ed8533' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5ba19970-d037-466e-84ed-d30385ed8533' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d6eccc4-a8c7-49c4-bc90-96d65192735e' class='xr-var-data-in' type='checkbox'><label for='data-7d6eccc4-a8c7-49c4-bc90-96d65192735e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-62456717-dd1b-478a-8954-d0234696111d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62456717-dd1b-478a-8954-d0234696111d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc4c5c25-b176-4f68-ada6-b03533afcf4e' class='xr-var-data-in' type='checkbox'><label for='data-bc4c5c25-b176-4f68-ada6-b03533afcf4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>quantile</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.95</div><input id='attrs-d14f00b8-65d3-4756-bb7f-dbe5e79a37b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d14f00b8-65d3-4756-bb7f-dbe5e79a37b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e06e6699-6add-4f6d-b360-5b4d5c67696f' class='xr-var-data-in' type='checkbox'><label for='data-e06e6699-6add-4f6d-b360-5b4d5c67696f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.95)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6ea2c7d8-dd27-4a27-8e4e-02f186b4a3db' class='xr-section-summary-in' type='checkbox'  ><label for='section-6ea2c7d8-dd27-4a27-8e4e-02f186b4a3db' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>angle</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5a7c55ef-e4eb-481a-96d3-b2d5b9c194f4' class='xr-index-data-in' type='checkbox'/><label for='index-5a7c55ef-e4eb-481a-96d3-b2d5b9c194f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330], dtype=&#x27;int64&#x27;, name=&#x27;angle&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>width</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-58501d05-3a60-4fc7-b7db-c57d55ac6f8d' class='xr-index-data-in' type='checkbox'/><label for='index-58501d05-3a60-4fc7-b7db-c57d55ac6f8d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([80], dtype=&#x27;int64&#x27;, name=&#x27;width&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>intensity</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ffdd8b4a-9a6a-46a1-bee7-74e35a0110f8' class='xr-index-data-in' type='checkbox'/><label for='index-ffdd8b4a-9a6a-46a1-bee7-74e35a0110f8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;intensity&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d17fc1ac-1413-4e6f-ad90-ef3cd9660e54' class='xr-index-data-in' type='checkbox'/><label for='index-d17fc1ac-1413-4e6f-ad90-ef3cd9660e54' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([37], dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1e3e1255-3276-4bb8-b344-4bb3f8ccc40a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1e3e1255-3276-4bb8-b344-4bb3f8ccc40a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">f</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>array([[0.8409317 , 1.0498772 , 1.153635  , 0.99954355, 0.725201  ,
        0.35095292, 0.02448581, 0.02457634, 0.0248986 , 0.02675291,
        0.03263285, 0.45294714],
       [1.132491  , 1.8973833 , 2.4750936 , 2.4592981 , 2.0500247 ,
        1.2972026 , 0.28873014, 0.11172125, 0.11461885, 0.11478255,
        0.11936502, 0.33047357]], dtype=float32)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">theta</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>(48,)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">polar</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>(&lt;Figure size 1500x1500 with 1 Axes&gt;, &lt;PolarAxes: &gt;)
</code></pre></div>

<p><img alt="png" src="../xarrayjoblib_files/xarrayjoblib_48_1.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">r</span> <span class="o">=</span> <span class="n">flash_responses</span><span class="p">(</span><span class="n">ensemble</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Loading ensemble:   0%|          | 0/2 [00:00&lt;?, ?it/s]


[2024-09-15 00:45:39] Loaded 2 networks.
[2024-09-15 00:45:47] Initialized network with NumberOfParams(free=734, fixed=2959) parameters.
[2024-09-15 00:45:47] Recovered network state.
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">flash_response_index</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;responses&#x27; (network_id: 2, sample: 1, neuron: 65)&gt;
array([[[ 1.07614057e-01,  1.22121731e-01,  1.65068723e-01,
          9.90826539e-02,  7.81758936e-02,  7.06098243e-02,
          2.54012198e-01,  1.06094743e-01, -3.33505716e-01,
         -3.30759988e-01, -4.61144274e-02, -4.64987452e-03,
          3.21964889e-01,  1.40345311e-01,  2.09036118e-01,
         -3.31612651e-01,  2.33435375e-02, -1.73169247e-01,
         -1.17779317e-01,  1.34492072e-01,  1.02727715e-01,
         -1.76974075e-02, -7.66650601e-02,  1.16897822e-01,
         -1.22651766e-01,  5.85589582e-02,  3.09883731e-03,
          2.24795478e-02,  3.76868920e-02, -4.32464480e-02,
          6.64255390e-03, -2.47358757e-01,  1.49016711e-01,
          1.54813057e-01,  1.70755602e-01, -2.73465852e-02,
         -4.46538091e-02, -4.55124657e-02, -3.11838756e-01,
          7.00730195e-02,  1.99072636e-02, -2.85479567e-02,
         -6.88058695e-02, -7.37968259e-02, -8.77654321e-02,
          9.95634700e-02, -2.78928023e-02, -1.47159989e-01,
         -2.15984130e-01, -2.41914828e-01,  6.56170456e-02,
         -1.26004951e-01, -1.52371329e-01,  2.79308999e-03,
         -4.09187021e-01,  2.35152115e-03, -2.35542726e-01,
         -1.86430399e-01, -6.13986298e-02,  5.93723500e-02,
...
          2.60737780e-02,  1.49129525e-01, -3.83035052e-02,
          2.58500827e-01, -1.08162738e-01, -6.37251487e-01,
          3.58503263e-02,  6.35645611e-02,  3.32480699e-01,
         -1.26485912e-02,  2.57151583e-01,  3.35483459e-02,
         -5.59388863e-02, -9.38400425e-03,  1.28558197e-02,
          2.54778123e-02,  3.70732946e-04,  8.87486053e-03,
         -4.49437102e-02, -2.88796158e-02,  1.37185521e-02,
         -6.92609680e-02,  7.50546404e-03,  4.91667330e-02,
          4.50039610e-02, -2.37194587e-01,  9.91999831e-02,
          6.38408455e-02,  1.23342521e-02, -3.86059987e-02,
         -2.74846637e-02, -7.21865688e-03, -1.98470330e-02,
         -3.73961642e-02, -1.51956316e-01,  2.61375302e-03,
         -1.43572131e-01,  3.36000500e-02,  1.09999275e-01,
          1.65108571e-01,  6.43148195e-02, -1.47615467e-01,
         -1.72241060e-03,  4.94636868e-03, -1.58389569e-01,
         -7.49176841e-02, -6.96112445e-02, -5.97895198e-02,
          1.85007748e-03,  1.34547756e-04,  3.09411905e-02,
         -6.61731191e-02, -2.40576061e-01,  1.92752325e-02,
         -6.33063077e-02,  5.53334928e-02,  2.24329286e-01,
          3.31206065e-02,  1.20604991e-02]]])
Coordinates:
  * network_id   (network_id) int64 0 1
  * neuron       (neuron) int64 0 1 2 3 4 5 6 7 8 ... 56 57 58 59 60 61 62 63 64
    cell_type    (neuron) &lt;U8 &#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; &#x27;R4&#x27; ... &#x27;TmY14&#x27; &#x27;TmY15&#x27; &#x27;TmY18&#x27;
    u            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    v            (neuron) int32 0 0 0 0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0 0 0 0
    baseline     (sample) float64 0.5
    radius       (sample) int64 6
    checkpoints  (network_id) object /groups/turaga/home/lappalainenj/FlyVis/...
Dimensions without coordinates: sample</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'responses'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 2</li><li><span>sample</span>: 1</li><li><span class='xr-has-index'>neuron</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-96ddcc59-5709-4038-a408-1fdde91bd973' class='xr-array-in' type='checkbox' checked><label for='section-96ddcc59-5709-4038-a408-1fdde91bd973' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.1076 0.1221 0.1651 0.09908 ... 0.05533 0.2243 0.03312 0.01206</span></div><div class='xr-array-data'><pre>array([[[ 1.07614057e-01,  1.22121731e-01,  1.65068723e-01,
          9.90826539e-02,  7.81758936e-02,  7.06098243e-02,
          2.54012198e-01,  1.06094743e-01, -3.33505716e-01,
         -3.30759988e-01, -4.61144274e-02, -4.64987452e-03,
          3.21964889e-01,  1.40345311e-01,  2.09036118e-01,
         -3.31612651e-01,  2.33435375e-02, -1.73169247e-01,
         -1.17779317e-01,  1.34492072e-01,  1.02727715e-01,
         -1.76974075e-02, -7.66650601e-02,  1.16897822e-01,
         -1.22651766e-01,  5.85589582e-02,  3.09883731e-03,
          2.24795478e-02,  3.76868920e-02, -4.32464480e-02,
          6.64255390e-03, -2.47358757e-01,  1.49016711e-01,
          1.54813057e-01,  1.70755602e-01, -2.73465852e-02,
         -4.46538091e-02, -4.55124657e-02, -3.11838756e-01,
          7.00730195e-02,  1.99072636e-02, -2.85479567e-02,
         -6.88058695e-02, -7.37968259e-02, -8.77654321e-02,
          9.95634700e-02, -2.78928023e-02, -1.47159989e-01,
         -2.15984130e-01, -2.41914828e-01,  6.56170456e-02,
         -1.26004951e-01, -1.52371329e-01,  2.79308999e-03,
         -4.09187021e-01,  2.35152115e-03, -2.35542726e-01,
         -1.86430399e-01, -6.13986298e-02,  5.93723500e-02,
...
          2.60737780e-02,  1.49129525e-01, -3.83035052e-02,
          2.58500827e-01, -1.08162738e-01, -6.37251487e-01,
          3.58503263e-02,  6.35645611e-02,  3.32480699e-01,
         -1.26485912e-02,  2.57151583e-01,  3.35483459e-02,
         -5.59388863e-02, -9.38400425e-03,  1.28558197e-02,
          2.54778123e-02,  3.70732946e-04,  8.87486053e-03,
         -4.49437102e-02, -2.88796158e-02,  1.37185521e-02,
         -6.92609680e-02,  7.50546404e-03,  4.91667330e-02,
          4.50039610e-02, -2.37194587e-01,  9.91999831e-02,
          6.38408455e-02,  1.23342521e-02, -3.86059987e-02,
         -2.74846637e-02, -7.21865688e-03, -1.98470330e-02,
         -3.73961642e-02, -1.51956316e-01,  2.61375302e-03,
         -1.43572131e-01,  3.36000500e-02,  1.09999275e-01,
          1.65108571e-01,  6.43148195e-02, -1.47615467e-01,
         -1.72241060e-03,  4.94636868e-03, -1.58389569e-01,
         -7.49176841e-02, -6.96112445e-02, -5.97895198e-02,
          1.85007748e-03,  1.34547756e-04,  3.09411905e-02,
         -6.61731191e-02, -2.40576061e-01,  1.92752325e-02,
         -6.33063077e-02,  5.53334928e-02,  2.24329286e-01,
          3.31206065e-02,  1.20604991e-02]]])</pre></div></div></li><li class='xr-section-item'><input id='section-c00045f9-2056-41a8-ba13-0557fef3860c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c00045f9-2056-41a8-ba13-0557fef3860c' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-f32d7313-cf40-49e3-a1c9-f7895dac41a6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f32d7313-cf40-49e3-a1c9-f7895dac41a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09620cab-3311-412e-969e-6d640f874dc8' class='xr-var-data-in' type='checkbox'><label for='data-09620cab-3311-412e-969e-6d640f874dc8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 59 60 61 62 63 64</div><input id='attrs-49f6dc6c-0fec-42f8-84fd-cbdbd784da01' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49f6dc6c-0fec-42f8-84fd-cbdbd784da01' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44e732e9-173d-400a-aeb7-f7136a7e0d4b' class='xr-var-data-in' type='checkbox'><label for='data-44e732e9-173d-400a-aeb7-f7136a7e0d4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R2&#x27; &#x27;R3&#x27; ... &#x27;TmY15&#x27; &#x27;TmY18&#x27;</div><input id='attrs-b379a287-052f-470c-b91b-ff9a37db61ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b379a287-052f-470c-b91b-ff9a37db61ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89ac90f0-0ceb-4acb-998a-b207fec03a2a' class='xr-var-data-in' type='checkbox'><label for='data-89ac90f0-0ceb-4acb-998a-b207fec03a2a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R2&#x27;, &#x27;R3&#x27;, &#x27;R4&#x27;, &#x27;R5&#x27;, &#x27;R6&#x27;, &#x27;R7&#x27;, &#x27;R8&#x27;, &#x27;L1&#x27;, &#x27;L2&#x27;, &#x27;L3&#x27;,
       &#x27;L4&#x27;, &#x27;L5&#x27;, &#x27;Lawf1&#x27;, &#x27;Lawf2&#x27;, &#x27;Am&#x27;, &#x27;C2&#x27;, &#x27;C3&#x27;, &#x27;CT1(Lo1)&#x27;,
       &#x27;CT1(M10)&#x27;, &#x27;Mi1&#x27;, &#x27;Mi2&#x27;, &#x27;Mi3&#x27;, &#x27;Mi4&#x27;, &#x27;Mi9&#x27;, &#x27;Mi10&#x27;, &#x27;Mi11&#x27;,
       &#x27;Mi12&#x27;, &#x27;Mi13&#x27;, &#x27;Mi14&#x27;, &#x27;Mi15&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T2a&#x27;, &#x27;T3&#x27;, &#x27;T4a&#x27;,
       &#x27;T4b&#x27;, &#x27;T4c&#x27;, &#x27;T4d&#x27;, &#x27;T5a&#x27;, &#x27;T5b&#x27;, &#x27;T5c&#x27;, &#x27;T5d&#x27;, &#x27;Tm1&#x27;, &#x27;Tm2&#x27;,
       &#x27;Tm3&#x27;, &#x27;Tm4&#x27;, &#x27;Tm5Y&#x27;, &#x27;Tm5a&#x27;, &#x27;Tm5b&#x27;, &#x27;Tm5c&#x27;, &#x27;Tm9&#x27;, &#x27;Tm16&#x27;,
       &#x27;Tm20&#x27;, &#x27;Tm28&#x27;, &#x27;Tm30&#x27;, &#x27;TmY3&#x27;, &#x27;TmY4&#x27;, &#x27;TmY5a&#x27;, &#x27;TmY9&#x27;, &#x27;TmY10&#x27;,
       &#x27;TmY13&#x27;, &#x27;TmY14&#x27;, &#x27;TmY15&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-243ef17e-d178-4feb-827f-baba49b97c3e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-243ef17e-d178-4feb-827f-baba49b97c3e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b963b87-203f-4424-9d29-32250f2e0af5' class='xr-var-data-in' type='checkbox'><label for='data-8b963b87-203f-4424-9d29-32250f2e0af5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-6f287e10-5ec1-4fa3-8894-3f2a947d7076' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f287e10-5ec1-4fa3-8894-3f2a947d7076' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ebf9a66-b093-40cd-a401-955f9b45977a' class='xr-var-data-in' type='checkbox'><label for='data-3ebf9a66-b093-40cd-a401-955f9b45977a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>baseline</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5</div><input id='attrs-a0e19a7f-c3a5-4d2f-bf08-e4a83a106b20' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0e19a7f-c3a5-4d2f-bf08-e4a83a106b20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da17eb47-6ce6-4b56-8724-79f60eae5b1c' class='xr-var-data-in' type='checkbox'><label for='data-da17eb47-6ce6-4b56-8724-79f60eae5b1c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radius</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6</div><input id='attrs-4556285a-3893-41f5-98d1-1df296a9b2b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4556285a-3893-41f5-98d1-1df296a9b2b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-640ce277-e29f-4be5-a737-e7c22094483a' class='xr-var-data-in' type='checkbox'><label for='data-640ce277-e29f-4be5-a737-e7c22094483a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>checkpoints</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>/groups/turaga/home/lappalainenj...</div><input id='attrs-73d403d0-939f-4bc4-bb26-1aae97fb4624' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-73d403d0-939f-4bc4-bb26-1aae97fb4624' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b2e4f77-7be6-4c7d-a5e1-d20b10d7ed3c' class='xr-var-data-in' type='checkbox'><label for='data-8b2e4f77-7be6-4c7d-a5e1-d20b10d7ed3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000&#x27;),
       PosixPath(&#x27;/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/001/chkpts/chkpt_00000&#x27;)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-81d46378-cd3e-47a9-9516-2a5f2bcb8342' class='xr-section-summary-in' type='checkbox'  ><label for='section-81d46378-cd3e-47a9-9516-2a5f2bcb8342' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-25411a3f-ac81-4327-8e13-3565785d299a' class='xr-index-data-in' type='checkbox'/><label for='index-25411a3f-ac81-4327-8e13-3565785d299a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fe4162fe-717d-445b-9cec-4f5bfd3572fd' class='xr-index-data-in' type='checkbox'/><label for='index-fe4162fe-717d-445b-9cec-4f5bfd3572fd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af3c8763-daeb-4645-9c46-89e2a9894dc2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-af3c8763-daeb-4645-9c46-89e2a9894dc2' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">ensemble</span> <span class="o">=</span> <span class="n">EnsembleView</span><span class="p">(</span><span class="s2">&quot;flow/0000&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>Loading ensemble:   0%|          | 0/50 [00:00&lt;?, ?it/s]


[2024-09-14 21:59:00] Loaded 50 networks.
</code></pre></div>

<div class="highlight"><pre><span></span><code>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">responses</span>
</code></pre></div>
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (network_id: 50, sample: 4, frame: 600, channel: 1,
                   hex_pixel: 721, neuron: 45669)
Coordinates: (12/14)
  * sample        (sample) int64 0 1 2 3
  * frame         (frame) int64 0 1 2 3 4 5 6 7 ... 593 594 595 596 597 598 599
    time          (frame) float64 -1.0 -0.995 -0.99 -0.985 ... 1.985 1.99 1.995
  * channel       (channel) int64 0
  * hex_pixel     (hex_pixel) int64 0 1 2 3 4 5 6 ... 715 716 717 718 719 720
  * neuron        (neuron) int64 0 1 2 3 4 5 ... 45664 45665 45666 45667 45668
    ...            ...
    v             (neuron) int32 0 1 2 3 4 5 6 7 8 ... -8 -7 -6 -5 -4 -3 -2 -1 0
    baseline      (sample) float64 0.5 0.5 0.5 0.5
    intensity     (sample) int64 0 0 1 1
    radius        (sample) int64 -1 6 -1 6
    network_name  (network_id) &lt;U13 &#x27;flow/0000/000&#x27; ... &#x27;flow/0000/049&#x27;
  * network_id    (network_id) int64 0 1 2 3 4 5 6 7 ... 42 43 44 45 46 47 48 49
Data variables:
    stimulus      (network_id, sample, frame, channel, hex_pixel) float32 0.5...
    responses     (network_id, sample, frame, neuron) float32 1.065 ... -0.06967
Attributes:
    config:           {&#x27;type&#x27;: &#x27;RenderedFlashes&#x27;, &#x27;boxfilter&#x27;: {&#x27;extent&#x27;: 15,...
    network_config:   Namespace(\n  connectome = Namespace(\n    type = &#x27;Conn...
    checkpoint_path:  /groups/turaga/home/lappalainenj/FlyVis/private/flyvisi...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-91789e8e-759d-4fa8-a34e-8f6b569462d0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-91789e8e-759d-4fa8-a34e-8f6b569462d0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>network_id</span>: 50</li><li><span class='xr-has-index'>sample</span>: 4</li><li><span class='xr-has-index'>frame</span>: 600</li><li><span class='xr-has-index'>channel</span>: 1</li><li><span class='xr-has-index'>hex_pixel</span>: 721</li><li><span class='xr-has-index'>neuron</span>: 45669</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7388b4d5-6c11-4068-9858-2156c4a56bee' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7388b4d5-6c11-4068-9858-2156c4a56bee' class='xr-section-summary' >Coordinates: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3</div><input id='attrs-595f2131-34b1-4426-b7d1-75e0a43ca35d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-595f2131-34b1-4426-b7d1-75e0a43ca35d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d7a88ee-5152-4879-8a6b-8d76d0505e23' class='xr-var-data-in' type='checkbox'><label for='data-5d7a88ee-5152-4879-8a6b-8d76d0505e23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 595 596 597 598 599</div><input id='attrs-a717eb1b-9825-4718-9f03-d7a840306c53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a717eb1b-9825-4718-9f03-d7a840306c53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-315b5f32-839e-4c55-a79c-380b3548f1b2' class='xr-var-data-in' type='checkbox'><label for='data-315b5f32-839e-4c55-a79c-380b3548f1b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 597, 598, 599])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -0.995 -0.99 ... 1.99 1.995</div><input id='attrs-d80c3cea-3458-49ef-a4fb-bb5d6a55ca2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d80c3cea-3458-49ef-a4fb-bb5d6a55ca2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-150eb9c7-c674-4054-86ec-5123460b4e9a' class='xr-var-data-in' type='checkbox'><label for='data-150eb9c7-c674-4054-86ec-5123460b4e9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1.   , -0.995, -0.99 , -0.985, -0.98 , -0.975, -0.97 , -0.965,
       -0.96 , -0.955, -0.95 , -0.945, -0.94 , -0.935, -0.93 , -0.925,
       -0.92 , -0.915, -0.91 , -0.905, -0.9  , -0.895, -0.89 , -0.885,
       -0.88 , -0.875, -0.87 , -0.865, -0.86 , -0.855, -0.85 , -0.845,
       -0.84 , -0.835, -0.83 , -0.825, -0.82 , -0.815, -0.81 , -0.805,
       -0.8  , -0.795, -0.79 , -0.785, -0.78 , -0.775, -0.77 , -0.765,
       -0.76 , -0.755, -0.75 , -0.745, -0.74 , -0.735, -0.73 , -0.725,
       -0.72 , -0.715, -0.71 , -0.705, -0.7  , -0.695, -0.69 , -0.685,
       -0.68 , -0.675, -0.67 , -0.665, -0.66 , -0.655, -0.65 , -0.645,
       -0.64 , -0.635, -0.63 , -0.625, -0.62 , -0.615, -0.61 , -0.605,
       -0.6  , -0.595, -0.59 , -0.585, -0.58 , -0.575, -0.57 , -0.565,
       -0.56 , -0.555, -0.55 , -0.545, -0.54 , -0.535, -0.53 , -0.525,
       -0.52 , -0.515, -0.51 , -0.505, -0.5  , -0.495, -0.49 , -0.485,
       -0.48 , -0.475, -0.47 , -0.465, -0.46 , -0.455, -0.45 , -0.445,
       -0.44 , -0.435, -0.43 , -0.425, -0.42 , -0.415, -0.41 , -0.405,
       -0.4  , -0.395, -0.39 , -0.385, -0.38 , -0.375, -0.37 , -0.365,
       -0.36 , -0.355, -0.35 , -0.345, -0.34 , -0.335, -0.33 , -0.325,
       -0.32 , -0.315, -0.31 , -0.305, -0.3  , -0.295, -0.29 , -0.285,
       -0.28 , -0.275, -0.27 , -0.265, -0.26 , -0.255, -0.25 , -0.245,
       -0.24 , -0.235, -0.23 , -0.225, -0.22 , -0.215, -0.21 , -0.205,
...
        1.2  ,  1.205,  1.21 ,  1.215,  1.22 ,  1.225,  1.23 ,  1.235,
        1.24 ,  1.245,  1.25 ,  1.255,  1.26 ,  1.265,  1.27 ,  1.275,
        1.28 ,  1.285,  1.29 ,  1.295,  1.3  ,  1.305,  1.31 ,  1.315,
        1.32 ,  1.325,  1.33 ,  1.335,  1.34 ,  1.345,  1.35 ,  1.355,
        1.36 ,  1.365,  1.37 ,  1.375,  1.38 ,  1.385,  1.39 ,  1.395,
        1.4  ,  1.405,  1.41 ,  1.415,  1.42 ,  1.425,  1.43 ,  1.435,
        1.44 ,  1.445,  1.45 ,  1.455,  1.46 ,  1.465,  1.47 ,  1.475,
        1.48 ,  1.485,  1.49 ,  1.495,  1.5  ,  1.505,  1.51 ,  1.515,
        1.52 ,  1.525,  1.53 ,  1.535,  1.54 ,  1.545,  1.55 ,  1.555,
        1.56 ,  1.565,  1.57 ,  1.575,  1.58 ,  1.585,  1.59 ,  1.595,
        1.6  ,  1.605,  1.61 ,  1.615,  1.62 ,  1.625,  1.63 ,  1.635,
        1.64 ,  1.645,  1.65 ,  1.655,  1.66 ,  1.665,  1.67 ,  1.675,
        1.68 ,  1.685,  1.69 ,  1.695,  1.7  ,  1.705,  1.71 ,  1.715,
        1.72 ,  1.725,  1.73 ,  1.735,  1.74 ,  1.745,  1.75 ,  1.755,
        1.76 ,  1.765,  1.77 ,  1.775,  1.78 ,  1.785,  1.79 ,  1.795,
        1.8  ,  1.805,  1.81 ,  1.815,  1.82 ,  1.825,  1.83 ,  1.835,
        1.84 ,  1.845,  1.85 ,  1.855,  1.86 ,  1.865,  1.87 ,  1.875,
        1.88 ,  1.885,  1.89 ,  1.895,  1.9  ,  1.905,  1.91 ,  1.915,
        1.92 ,  1.925,  1.93 ,  1.935,  1.94 ,  1.945,  1.95 ,  1.955,
        1.96 ,  1.965,  1.97 ,  1.975,  1.98 ,  1.985,  1.99 ,  1.995])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>channel</span></div><div class='xr-var-dims'>(channel)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-a4b7fc17-0a7a-483a-9fd2-52d3c5da609c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4b7fc17-0a7a-483a-9fd2-52d3c5da609c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-092754a5-1f58-4acf-981f-87c3e85e75a8' class='xr-var-data-in' type='checkbox'><label for='data-092754a5-1f58-4acf-981f-87c3e85e75a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>hex_pixel</span></div><div class='xr-var-dims'>(hex_pixel)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 716 717 718 719 720</div><input id='attrs-e7c3778c-583c-4ba2-9697-7832c0eb32ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7c3778c-583c-4ba2-9697-7832c0eb32ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea012206-f076-42c9-9999-c4e3abf55079' class='xr-var-data-in' type='checkbox'><label for='data-ea012206-f076-42c9-9999-c4e3abf55079' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 718, 719, 720])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>neuron</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 ... 45665 45666 45667 45668</div><input id='attrs-c79e24f7-3e75-49a6-9898-847993c653ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c79e24f7-3e75-49a6-9898-847993c653ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-688b889b-b03a-4cb2-a00d-c2b801e5a0b2' class='xr-var-data-in' type='checkbox'><label for='data-688b889b-b03a-4cb2-a00d-c2b801e5a0b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    0,     1,     2, ..., 45666, 45667, 45668])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_type</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;R1&#x27; &#x27;R1&#x27; &#x27;R1&#x27; ... &#x27;TmY18&#x27; &#x27;TmY18&#x27;</div><input id='attrs-d3dc1678-aa8d-463b-9b4e-3f1091d7e096' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d3dc1678-aa8d-463b-9b4e-3f1091d7e096' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-505d55a1-7772-4e57-9f58-f2cd6b16fc70' class='xr-var-data-in' type='checkbox'><label for='data-505d55a1-7772-4e57-9f58-f2cd6b16fc70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;R1&#x27;, &#x27;R1&#x27;, &#x27;R1&#x27;, ..., &#x27;TmY18&#x27;, &#x27;TmY18&#x27;, &#x27;TmY18&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>-15 -15 -15 -15 -15 ... 15 15 15 15</div><input id='attrs-1c32bd84-a8bd-4bd5-9c02-bd10df393351' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1c32bd84-a8bd-4bd5-9c02-bd10df393351' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9422943c-a8d7-46d6-ab85-4a0c314fcfd8' class='xr-var-data-in' type='checkbox'><label for='data-9422943c-a8d7-46d6-ab85-4a0c314fcfd8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-15, -15, -15, ...,  15,  15,  15], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(neuron)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... -5 -4 -3 -2 -1 0</div><input id='attrs-9a8ce2d7-9cab-4c0e-8d20-74bc5c5e6abf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a8ce2d7-9cab-4c0e-8d20-74bc5c5e6abf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a33ac910-6efb-4261-97c2-d12738bc8652' class='xr-var-data-in' type='checkbox'><label for='data-a33ac910-6efb-4261-97c2-d12738bc8652' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2, ..., -2, -1,  0], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>baseline</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5 0.5 0.5 0.5</div><input id='attrs-9219f78a-6631-4428-a1d3-575851880b4d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9219f78a-6631-4428-a1d3-575851880b4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3451290-f19c-4e6f-9895-83a91e4934fa' class='xr-var-data-in' type='checkbox'><label for='data-e3451290-f19c-4e6f-9895-83a91e4934fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.5, 0.5, 0.5, 0.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>intensity</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1</div><input id='attrs-5b5d4984-553e-47d1-a0fe-2fa25df6dd98' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b5d4984-553e-47d1-a0fe-2fa25df6dd98' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea0f84bd-4dd8-4a2b-8e8a-986c04aaa391' class='xr-var-data-in' type='checkbox'><label for='data-ea0f84bd-4dd8-4a2b-8e8a-986c04aaa391' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radius</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-1 6 -1 6</div><input id='attrs-d4755c6a-6732-4db6-94e0-e721515e5aaf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d4755c6a-6732-4db6-94e0-e721515e5aaf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24df0a99-a50a-403e-bbf7-6b700526f976' class='xr-var-data-in' type='checkbox'><label for='data-24df0a99-a50a-403e-bbf7-6b700526f976' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1,  6, -1,  6])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>network_name</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>&lt;U13</div><div class='xr-var-preview xr-preview'>&#x27;flow/0000/000&#x27; ... &#x27;flow/0000/049&#x27;</div><input id='attrs-548c439a-e02e-4b80-82f9-c8d763150b22' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-548c439a-e02e-4b80-82f9-c8d763150b22' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c0be372-ae29-44d1-9c3e-7297bc474cbf' class='xr-var-data-in' type='checkbox'><label for='data-1c0be372-ae29-44d1-9c3e-7297bc474cbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;flow/0000/000&#x27;, &#x27;flow/0000/001&#x27;, &#x27;flow/0000/002&#x27;, &#x27;flow/0000/003&#x27;,
       &#x27;flow/0000/004&#x27;, &#x27;flow/0000/005&#x27;, &#x27;flow/0000/006&#x27;, &#x27;flow/0000/007&#x27;,
       &#x27;flow/0000/008&#x27;, &#x27;flow/0000/009&#x27;, &#x27;flow/0000/010&#x27;, &#x27;flow/0000/011&#x27;,
       &#x27;flow/0000/012&#x27;, &#x27;flow/0000/013&#x27;, &#x27;flow/0000/014&#x27;, &#x27;flow/0000/015&#x27;,
       &#x27;flow/0000/016&#x27;, &#x27;flow/0000/017&#x27;, &#x27;flow/0000/018&#x27;, &#x27;flow/0000/019&#x27;,
       &#x27;flow/0000/020&#x27;, &#x27;flow/0000/021&#x27;, &#x27;flow/0000/022&#x27;, &#x27;flow/0000/023&#x27;,
       &#x27;flow/0000/024&#x27;, &#x27;flow/0000/025&#x27;, &#x27;flow/0000/026&#x27;, &#x27;flow/0000/027&#x27;,
       &#x27;flow/0000/028&#x27;, &#x27;flow/0000/029&#x27;, &#x27;flow/0000/030&#x27;, &#x27;flow/0000/031&#x27;,
       &#x27;flow/0000/032&#x27;, &#x27;flow/0000/033&#x27;, &#x27;flow/0000/034&#x27;, &#x27;flow/0000/035&#x27;,
       &#x27;flow/0000/036&#x27;, &#x27;flow/0000/037&#x27;, &#x27;flow/0000/038&#x27;, &#x27;flow/0000/039&#x27;,
       &#x27;flow/0000/040&#x27;, &#x27;flow/0000/041&#x27;, &#x27;flow/0000/042&#x27;, &#x27;flow/0000/043&#x27;,
       &#x27;flow/0000/044&#x27;, &#x27;flow/0000/045&#x27;, &#x27;flow/0000/046&#x27;, &#x27;flow/0000/047&#x27;,
       &#x27;flow/0000/048&#x27;, &#x27;flow/0000/049&#x27;], dtype=&#x27;&lt;U13&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>network_id</span></div><div class='xr-var-dims'>(network_id)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-291b5190-4c35-44f3-a119-734ed250bd5f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-291b5190-4c35-44f3-a119-734ed250bd5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12eb324c-c567-4a60-8724-03cab5e2bcef' class='xr-var-data-in' type='checkbox'><label for='data-12eb324c-c567-4a60-8724-03cab5e2bcef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a49c88cb-a89e-4196-9867-7a96e09b4c11' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a49c88cb-a89e-4196-9867-7a96e09b4c11' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>stimulus</span></div><div class='xr-var-dims'>(network_id, sample, frame, channel, hex_pixel)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5 0.5 0.5 0.5 ... 0.5 0.5 0.5 0.5</div><input id='attrs-c7825049-8759-41f6-8f21-cee91470cb8a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7825049-8759-41f6-8f21-cee91470cb8a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbd15214-efd7-41e1-bd39-573dc639154b' class='xr-var-data-in' type='checkbox'><label for='data-cbd15214-efd7-41e1-bd39-573dc639154b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         ...,

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]]],


        [[[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],
...
         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]]],


        [[[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         ...,

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]],

         [[0.5, 0.5, 0.5, ..., 0.5, 0.5, 0.5]]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>responses</span></div><div class='xr-var-dims'>(network_id, sample, frame, neuron)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.065 1.064 ... -0.08417 -0.06967</div><input id='attrs-89210541-c973-4d09-9fc5-9d6d27451df7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-89210541-c973-4d09-9fc5-9d6d27451df7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-182d6cc3-3d33-47b7-be9c-79c5396ddb8b' class='xr-var-data-in' type='checkbox'><label for='data-182d6cc3-3d33-47b7-be9c-79c5396ddb8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0037799 ,
           1.1802369 ,  1.1758567 ],
         [ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0038444 ,
           1.1802994 ,  1.1759069 ],
         [ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0039065 ,
           1.1803595 ,  1.1759552 ],
         ...,
         [ 1.0647607 ,  1.0643051 ,  1.0641189 , ...,  1.0035812 ,
           1.180073  ,  1.1758418 ],
         [ 1.0647606 ,  1.064305  ,  1.0641187 , ...,  1.0036479 ,
           1.1801381 ,  1.1758913 ],
         [ 1.0647606 ,  1.0643048 ,  1.0641186 , ...,  1.0037123 ,
           1.1802008 ,  1.175939  ]],

        [[ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0037799 ,
           1.1802369 ,  1.1758567 ],
         [ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0038444 ,
           1.1802994 ,  1.1759069 ],
         [ 1.0647585 ,  1.0643023 ,  1.064116  , ...,  1.0039065 ,
           1.1803595 ,  1.1759552 ],
...
         [-0.48008505, -0.48008505, -0.48008505, ...,  0.31707653,
           0.31497094,  0.33054996],
         [-0.48008505, -0.48008505, -0.48008505, ...,  0.31687245,
           0.31478694,  0.3304082 ],
         [-0.48008505, -0.48008505, -0.48008505, ...,  0.31667095,
           0.31460539,  0.33026838]],

        [[-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.39424074,
          -0.30051097, -0.13593647],
         [-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.39432457,
          -0.30055374, -0.13596988],
         [-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.39441872,
          -0.30060574, -0.13601004],
         ...,
         [-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.14209548,
          -0.08404877, -0.06954683],
         [-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.14215337,
          -0.08410751, -0.06960863],
         [-0.4800851 , -0.4800851 , -0.4800851 , ..., -0.14221065,
          -0.0841656 , -0.06966969]]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-47bea2be-b790-4d70-a0a7-d5dd44a49c1d' class='xr-section-summary-in' type='checkbox'  ><label for='section-47bea2be-b790-4d70-a0a7-d5dd44a49c1d' class='xr-section-summary' >Indexes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>sample</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c761d1aa-1a33-4d99-848a-a3ef92204d64' class='xr-index-data-in' type='checkbox'/><label for='index-c761d1aa-1a33-4d99-848a-a3ef92204d64' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3], dtype=&#x27;int64&#x27;, name=&#x27;sample&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>frame</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b8673b6c-0d29-4780-a982-6c596da4ee38' class='xr-index-data-in' type='checkbox'/><label for='index-b8673b6c-0d29-4780-a982-6c596da4ee38' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       590, 591, 592, 593, 594, 595, 596, 597, 598, 599],
      dtype=&#x27;int64&#x27;, name=&#x27;frame&#x27;, length=600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>channel</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fd3aa4ef-76f8-4f74-b0eb-97c49e10b35f' class='xr-index-data-in' type='checkbox'/><label for='index-fd3aa4ef-76f8-4f74-b0eb-97c49e10b35f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0], dtype=&#x27;int64&#x27;, name=&#x27;channel&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>hex_pixel</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-08df5629-85d3-4b62-9524-a2b43aceb7b9' class='xr-index-data-in' type='checkbox'/><label for='index-08df5629-85d3-4b62-9524-a2b43aceb7b9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       711, 712, 713, 714, 715, 716, 717, 718, 719, 720],
      dtype=&#x27;int64&#x27;, name=&#x27;hex_pixel&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>neuron</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1c39df30-1124-4ec5-9047-f697aac666a3' class='xr-index-data-in' type='checkbox'/><label for='index-1c39df30-1124-4ec5-9047-f697aac666a3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([    0,     1,     2,     3,     4,     5,     6,     7,     8,     9,
       ...
       45659, 45660, 45661, 45662, 45663, 45664, 45665, 45666, 45667, 45668],
      dtype=&#x27;int64&#x27;, name=&#x27;neuron&#x27;, length=45669))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>network_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b706bd60-881c-4759-8941-c39cef3c280f' class='xr-index-data-in' type='checkbox'/><label for='index-b706bd60-881c-4759-8941-c39cef3c280f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49],
      dtype=&#x27;int64&#x27;, name=&#x27;network_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ad2300b9-c72b-4e13-9988-8bbf43bc90c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ad2300b9-c72b-4e13-9988-8bbf43bc90c6' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>config :</span></dt><dd>{&#x27;type&#x27;: &#x27;RenderedFlashes&#x27;, &#x27;boxfilter&#x27;: {&#x27;extent&#x27;: 15, &#x27;kernel_size&#x27;: 13}, &#x27;dynamic_range&#x27;: [0, 1], &#x27;t_stim&#x27;: 1.0, &#x27;t_pre&#x27;: 1.0, &#x27;dt&#x27;: 0.005, &#x27;radius&#x27;: [-1, 6], &#x27;alternations&#x27;: [0, 1, 0]}</dd><dt><span>network_config :</span></dt><dd>Namespace(
  connectome = Namespace(
    type = &#x27;ConnectomeDir&#x27;,
    file = &#x27;fib25-fib19_v2.2.json&#x27;,
    extent = 15,
    n_syn_fill = 1
  ),
  dynamics = Namespace(
    type = &#x27;PPNeuronIGRSynapses&#x27;,
    activation = Namespace(type=&#x27;relu&#x27;)
  ),
  node_config = Namespace(
    bias = Namespace(
      type = &#x27;RestingPotential&#x27;,
      groupby = [&#x27;type&#x27;],
      initial_dist = &#x27;Normal&#x27;,
      mode = &#x27;sample&#x27;,
      requires_grad = True,
      mean = 0.5,
      std = 0.05,
      penalize = Namespace(activity=True),
      seed = 0
    ),
    time_const = Namespace(
      type = &#x27;TimeConstant&#x27;,
      groupby = [&#x27;type&#x27;],
      initial_dist = &#x27;Value&#x27;,
      value = 0.05,
      requires_grad = True
    )
  ),
  edge_config = Namespace(
    sign = Namespace(
      type = &#x27;SynapseSign&#x27;,
      initial_dist = &#x27;Value&#x27;,
      requires_grad = False,
      groupby = [&#x27;source_type&#x27;, &#x27;target_type&#x27;]
    ),
    syn_count = Namespace(
      type = &#x27;SynapseCount&#x27;,
      initial_dist = &#x27;Lognormal&#x27;,
      mode = &#x27;mean&#x27;,
      requires_grad = False,
      std = 1.0,
      groupby = [&#x27;source_type&#x27;, &#x27;target_type&#x27;, &#x27;du&#x27;, &#x27;dv&#x27;]
    ),
    syn_strength = Namespace(
      type = &#x27;SynapseCountScaling&#x27;,
      initial_dist = &#x27;Value&#x27;,
      requires_grad = True,
      scale_elec = 0.01,
      scale_chem = 0.01,
      clamp = &#x27;non_negative&#x27;,
      groupby = [&#x27;source_type&#x27;, &#x27;target_type&#x27;, &#x27;edge_type&#x27;]
    )
  )
)</dd><dt><span>checkpoint_path :</span></dt><dd>/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/data/results/flow/0000/000/chkpts/chkpt_00000</dd></dl></div></li></ul></div></div>

<div class="highlight"><pre><span></span><code><span class="n">responses</span> <span class="o">=</span> <span class="n">flash_responses</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>[2024-09-14 22:06:52] Recovered network state.
[2024-09-14 22:06:52] Recovered network state.
[2024-09-14 22:06:53] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:00] Recovered network state.
[2024-09-14 22:07:00] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:07:00] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:07] Recovered network state.
[2024-09-14 22:07:07] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:07:08] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:14] Recovered network state.
[2024-09-14 22:07:14] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:07:15] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:22] Recovered network state.
[2024-09-14 22:07:22] Recovered network state.


________________________________________________compute_responses - 6.4s, 0.1min


[2024-09-14 22:07:22] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:29] Recovered network state.
[2024-09-14 22:07:29] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:07:30] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:36] Recovered network state.
[2024-09-14 22:07:36] Recovered network state.


________________________________________________compute_responses - 6.4s, 0.1min


[2024-09-14 22:07:37] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:44] Recovered network state.
[2024-09-14 22:07:44] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:07:44] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:51] Recovered network state.
[2024-09-14 22:07:51] Recovered network state.


________________________________________________compute_responses - 6.4s, 0.1min


[2024-09-14 22:07:52] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:07:58] Recovered network state.
[2024-09-14 22:07:58] Recovered network state.


________________________________________________compute_responses - 6.4s, 0.1min


[2024-09-14 22:07:59] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:08:05] Recovered network state.
[2024-09-14 22:08:05] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:08:06] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:08:13] Recovered network state.
[2024-09-14 22:08:13] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:08:14] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.51s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:08:20] Recovered network state.
[2024-09-14 22:08:20] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:08:21] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:08:28] Recovered network state.
[2024-09-14 22:08:28] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:08:29] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:08:35] Recovered network state.
[2024-09-14 22:08:35] Recovered network state.


________________________________________________compute_responses - 6.6s, 0.1min


[2024-09-14 22:08:37] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:08:43] Recovered network state.
[2024-09-14 22:08:43] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:08:44] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.52s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:08:51] Recovered network state.
[2024-09-14 22:08:51] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:08:52] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.53s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:08:59] Recovered network state.
[2024-09-14 22:08:59] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:09:00] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:07] Recovered network state.
[2024-09-14 22:09:07] Recovered network state.


________________________________________________compute_responses - 6.8s, 0.1min


[2024-09-14 22:09:08] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:15] Recovered network state.
[2024-09-14 22:09:15] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:09:16] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:23] Recovered network state.
[2024-09-14 22:09:23] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:09:24] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:30] Recovered network state.
[2024-09-14 22:09:30] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:09:32] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:38] Recovered network state.
[2024-09-14 22:09:38] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:09:39] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:46] Recovered network state.
[2024-09-14 22:09:46] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:09:47] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:09:53] Recovered network state.
[2024-09-14 22:09:53] Recovered network state.


________________________________________________compute_responses - 6.6s, 0.1min


[2024-09-14 22:09:54] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:01] Recovered network state.
[2024-09-14 22:10:01] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:10:01] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:08] Recovered network state.
[2024-09-14 22:10:08] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:10:09] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:15] Recovered network state.
[2024-09-14 22:10:15] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:10:16] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:23] Recovered network state.
[2024-09-14 22:10:23] Recovered network state.


________________________________________________compute_responses - 6.6s, 0.1min


[2024-09-14 22:10:24] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:30] Recovered network state.
[2024-09-14 22:10:30] Recovered network state.


________________________________________________compute_responses - 6.6s, 0.1min


[2024-09-14 22:10:31] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:38] Recovered network state.
[2024-09-14 22:10:38] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:10:39] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:45] Recovered network state.
[2024-09-14 22:10:45] Recovered network state.


________________________________________________compute_responses - 6.5s, 0.1min


[2024-09-14 22:10:46] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:10:53] Recovered network state.
[2024-09-14 22:10:53] Recovered network state.


________________________________________________compute_responses - 6.6s, 0.1min


[2024-09-14 22:10:54] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:01] Recovered network state.
[2024-09-14 22:11:01] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:11:02] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.54s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:11:08] Recovered network state.
[2024-09-14 22:11:08] Recovered network state.


________________________________________________compute_responses - 6.8s, 0.1min


[2024-09-14 22:11:10] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:16] Recovered network state.
[2024-09-14 22:11:16] Recovered network state.


________________________________________________compute_responses - 6.8s, 0.1min


[2024-09-14 22:11:17] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:24] Recovered network state.
[2024-09-14 22:11:24] Recovered network state.


________________________________________________compute_responses - 6.7s, 0.1min


[2024-09-14 22:11:25] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:32] Recovered network state.
[2024-09-14 22:11:32] Recovered network state.


________________________________________________compute_responses - 6.9s, 0.1min


[2024-09-14 22:11:33] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:40] Recovered network state.
[2024-09-14 22:11:40] Recovered network state.


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:11:42] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:49] Recovered network state.
[2024-09-14 22:11:49] Recovered network state.


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:11:50] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:11:57] Recovered network state.
[2024-09-14 22:11:57] Recovered network state.


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:11:58] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:12:05] Recovered network state.
[2024-09-14 22:12:05] Recovered network state.
[2024-09-14 22:12:06] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:12:13] Recovered network state.
[2024-09-14 22:12:13] Recovered network state.


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:12:15] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:12:22] Recovered network state.
[2024-09-14 22:12:22] Recovered network state.


________________________________________________compute_responses - 7.3s, 0.1min


[2024-09-14 22:12:23] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.57s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:12:30] Recovered network state.
[2024-09-14 22:12:30] Recovered network state.


________________________________________________compute_responses - 7.1s, 0.1min


[2024-09-14 22:12:31] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.56s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:12:39] Recovered network state.
[2024-09-14 22:12:39] Recovered network state.


________________________________________________compute_responses - 7.0s, 0.1min


[2024-09-14 22:12:40] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.55s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:12:47] Recovered network state.
[2024-09-14 22:12:47] Recovered network state.


________________________________________________compute_responses - 7.0s, 0.1min


[2024-09-14 22:12:48] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:12:55] Recovered network state.
[2024-09-14 22:12:55] Recovered network state.


________________________________________________compute_responses - 7.2s, 0.1min


[2024-09-14 22:12:56] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


[2024-09-14 22:13:04] Recovered network state.
[2024-09-14 22:13:04] Recovered network state.


________________________________________________compute_responses - 7.2s, 0.1min


[2024-09-14 22:13:05] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


/groups/turaga/home/lappalainenj/FlyVis/private/flyvision/flyvision/analysis/stimulus_responses.py:136: UserWarning: Persisting input arguments took 0.50s to run.If this happens often in your code, it can cause performance problems (results will be correct in all cases). The reason for this is probably some large input arguments for a wrapped function.
  ds = memory_cache(compute_responses)(
[2024-09-14 22:13:12] Recovered network state.
[2024-09-14 22:13:12] Recovered network state.


________________________________________________compute_responses - 6.8s, 0.1min


[2024-09-14 22:13:13] Computing 4 stimulus responses.


________________________________________________________________________________
[Memory] Calling flyvision.analysis.stimulus_responses.compute_responses...
compute_responses(CheckpointedNetwork(network_class=&lt;class &#39;flyvision.network.Network&#39;&gt;, config={&#39;connectome&#39;: {&#39;type&#39;: &#39;ConnectomeDir&#39;, &#39;file&#39;: &#39;fib25-fib19_v2.2.json&#39;, &#39;extent&#39;: 15, &#39;n_syn_fill&#39;: 1}, &#39;dynamics&#39;: {&#39;type&#39;: &#39;PPNeuronIGRSynapses&#39;, &#39;activation&#39;: {&#39;type&#39;: &#39;relu&#39;}}, &#39;node_config&#39;: {&#39;bias&#39;: {&#39;type&#39;: &#39;RestingPotential&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Normal&#39;, &#39;mode&#39;: &#39;sample&#39;, &#39;requires_grad&#39;: True, &#39;mean&#39;: 0.5, &#39;std&#39;: 0.05, &#39;penalize&#39;: {&#39;activity&#39;: True}, &#39;seed&#39;: 0}, &#39;time_const&#39;: {&#39;type&#39;: &#39;TimeConstant&#39;, &#39;groupby&#39;: [&#39;type&#39;], &#39;initial_dist&#39;: &#39;Value&#39;, &#39;value&#39;: 0.05, &#39;requires_grad&#39;: True}}, &#39;edge_config&#39;: {&#39;sign&#39;: {&#39;type&#39;: &#39;SynapseSign&#39;, &#39;initial_dist&#39;: &#39;Value&#39;, &#39;requires_grad&#39;: False, &#39;group..., 
&lt;class &#39;flyvision.datasets.flashes.Flashes&#39;&gt;, { &#39;alternations&#39;: (0, 1, 0),
  &#39;dt&#39;: 0.005,
  &#39;dynamic_range&#39;: [0, 1],
  &#39;radius&#39;: (-1, 6),
  &#39;t_pre&#39;: 1.0,
  &#39;t_stim&#39;: 1}, 
1, 1.0, 0.0)



Batch:   0%|          | 0/4 [00:00&lt;?, ?it/s]


________________________________________________compute_responses - 6.9s, 0.1min
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flyvision.utils.chkpt_utils</span> <span class="kn">import</span> <span class="n">recover_network</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CheckpointedNetwork</span><span class="p">:</span>
    <span class="n">network_class</span><span class="p">:</span> <span class="n">Any</span>  <span class="c1"># Network class (e.g., flyvision.Network)</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span>  <span class="c1"># Configuration for the network</span>
    <span class="n">checkpoint</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Checkpoint path</span>
    <span class="n">recover_fn</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">recover_network</span>  <span class="c1"># Function to recover the network</span>
    <span class="n">network</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Network instance</span>

    <span class="k">def</span> <span class="nf">pre_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">eval</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pre-initialize the network.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_class</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">eval</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span>

    <span class="k">def</span> <span class="nf">recover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recover the network from the checkpoint.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recover_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">network</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom hash function that includes only hashable attributes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">network_class</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkpoint</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">checkpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="n">checkpoint</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkpoints</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CheckpointedNetwork</span><span class="p">(</span>
        <span class="n">network_class</span><span class="o">=</span><span class="n">network_class</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">checkpoint</span><span class="o">=</span><span class="n">checkpoint</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
    
  </body>
</html>